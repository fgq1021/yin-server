{"version":3,"file":"nodeTree-1513a54a.js","sources":["../../node_modules/@vicons/material/es/AddCircleOutlineFilled.js","../../node_modules/@vicons/material/es/ContentCopyFilled.js","../../node_modules/@vicons/material/es/CopyAllFilled.js","../../node_modules/@vicons/material/es/DashboardRound.js","../../node_modules/@vicons/material/es/DeleteOutlineFilled.js","../../node_modules/@vicons/material/es/ForkLeftFilled.js","../../node_modules/@vicons/material/es/FullscreenExitFilled.js","../../node_modules/@vicons/material/es/FullscreenFilled.js","../../node_modules/@vicons/material/es/RampRightFilled.js","../../node_modules/@vicons/material/es/SaveAllOutlined.js","../../node_modules/@vicons/material/es/UploadOutlined.js","../../src/components/node/menu/yinMenu.vue","../../src/components/node/menu/yinMenuObject.vue","../../src/components/node/menu/yinMenuObject.vue","../../src/components/node/menu/yinMenuStructure.vue","../../src/components/node/menu/yinMenuStructure.vue","../../src/components/editor/saveAll.vue","../../src/components/editor/saveAll.vue","../../src/components/editor/tinyRadio.vue","../../src/components/editor/tinyRadio.vue","../../src/components/node/chat/dialogSchema.vue","../../src/components/node/chat/dialogSchema.vue","../../src/components/node/chat/dialogScript.vue","../../src/components/node/chat/dialogScript.vue","../../src/components/node/panel/yinBigModel.vue","../../src/components/node/panel/yinBigModel.vue","../../src/components/node/panel/yinAuth.vue","../../src/components/node/panel/yinAuth.vue","../../src/components/node/nodeTree.vue","../../src/components/node/nodeTree.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'AddCircleOutlineFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'ContentCopyFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H9V4h9v12zM3 15v-2h2v2H3zm0-5.5h2v2H3v-2zM10 20h2v2h-2v-2zm-7-1.5v-2h2v2H3zM5 22c-1.1 0-2-.9-2-2h2v2zm3.5 0h-2v-2h2v2zm5 0v-2h2c0 1.1-.9 2-2 2zM5 6v2H3c0-1.1.9-2 2-2z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'CopyAllFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zm0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1zm10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zM13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'DashboardRound',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'DeleteOutlineFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M9.41 15.59L8 17l-4-4l4-4l1.41 1.41L7.83 12c1.51-.33 3.73.08 5.17 1.36V6.83l-1.59 1.59L10 7l4-4l4 4l-1.41 1.41L15 6.83V21h-2v-4c-.73-2.58-3.07-3.47-5.17-3l1.58 1.59z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'ForkLeftFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'FullscreenExitFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'FullscreenFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M11 21h2V6.83l1.59 1.59L16 7l-4-4l-4 4l1.41 1.41L11 6.83V9c0 4.27-4.03 7.13-6 8.27l1.46 1.46C8.37 17.56 9.9 16.19 11 14.7V21z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'RampRightFilled',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M17 6H8a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h11c1.1 0 2-.9 2-2v-9l-4-4zm2 13H8V8h8.17L19 10.83V19z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M9 9h6v2H9z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_4 = /*#__PURE__*/ _createElementVNode(\n  'circle',\n  {\n    cx: '13.5',\n    cy: '15.5',\n    r: '2.5',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_5 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M2 4a2 2 0 0 1 2-2h10v2H4v10H2V4z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_6 = [_hoisted_2, _hoisted_3, _hoisted_4, _hoisted_5]\nexport default defineComponent({\n  name: 'SaveAllOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_6)\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 24 24'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createElementVNode(\n  'path',\n  {\n    d: 'M9 16h6v-6h4l-7-7l-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = [_hoisted_2]\nexport default defineComponent({\n  name: 'UploadOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createElementBlock('svg', _hoisted_1, _hoisted_3)\n  }\n})\n","<template>\r\n  <div class=\"nodeMenu\">\r\n    <div class=\"targetBox\">\r\n      <slot name=\"target\"/>\r\n    </div>\r\n    <div class=\"itemList\">\r\n      <slot/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"less\">\r\n@keyframes menuShow {\r\n  from {\r\n    opacity: 0;\r\n    transform: translate(-50%, -50%) scale(0);\r\n  }\r\n}\r\n\r\n.nodeMenu {\r\n  position: absolute;\r\n  background-color: var(--color-background);\r\n  border: var(--color-border) 1px solid;\r\n  border-radius: var(--border-radius);\r\n  z-index: 1001;\r\n  transition: all 100ms cubic-bezier(0, 0, 0, 1.15);\r\n  animation: menuShow 100ms cubic-bezier(0, 0, 0, 1.15);\r\n\r\n\r\n  p {\r\n    word-break: keep-all;\r\n    white-space: nowrap;\r\n  }\r\n\r\n\r\n  .targetBox {\r\n    padding: 8px 13px;\r\n    border-bottom: var(--color-border) 1px solid;\r\n    display: flex;\r\n    align-items: flex-end;\r\n    justify-content: space-between;\r\n    cursor: default;\r\n\r\n\r\n    & > p {\r\n      font-size: smaller;\r\n      opacity: 0.7;\r\n    }\r\n\r\n    .main {\r\n      font-size: unset;\r\n      opacity: unset;\r\n      margin-right: 13px;\r\n    }\r\n  }\r\n\r\n  .itemList {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 4px;\r\n\r\n\r\n    hr {\r\n      //color: var(--color-border);\r\n      border: none;\r\n      border-bottom: var(--color-border) 1px solid;\r\n      margin: 4px 0;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin, Place} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport {DeleteOutlineFilled, CopyAllFilled, ContentCopyFilled, DashboardRound, ForkLeftFilled} from \"@vicons/material\";\r\nimport YinMenu from \"@/components/node/menu/yinMenu.vue\";\r\nimport YinMenuItem from \"@/components/node/menu/yinMenuItem.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinMenuObject\",\r\n  components: {\r\n    ForkLeftFilled,\r\n    YinMenuItem, YinMenu, DeleteOutlineFilled, CopyAllFilled, ContentCopyFilled, DashboardRound\r\n  },\r\n  props: ['screen', 'objectList', 'right'],\r\n  data() {\r\n    return {\r\n      object: {} as any,\r\n      parent: null,\r\n      key: null,\r\n      objectNode: null,\r\n      inArray: true\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      try {\r\n        this.object = await yin.get(this.screen.menu.target)\r\n        const node = this.objectList[this.screen.menu.target]\r\n        this.objectNode = node\r\n        if (node) {\r\n          this.parent = await yin.get(node.parent)\r\n          this.key = this.parent._schemaMix[node.parent.key]\r\n          this.inArray = this.key.type === 'Array'\r\n        }\r\n      }\r\n      catch (e) {\r\n        // console.log(e)\r\n      }\r\n    },\r\n    putEvent(event) {\r\n      this.screen.events[this.screen.menu.target] = event\r\n    },\r\n    putEvents(event) {\r\n      for (let id of this.screen.target) {\r\n        this.screen.events[id] = event\r\n      }\r\n    },\r\n    async putParentsEvents(event) {\r\n      for (let id of this.screen.target) {\r\n        const node = this.objectList[id]\r\n        if (node.parents)\r\n          for (let p in node.parents) {\r\n            this.screen.events[p] = event\r\n          }\r\n      }\r\n    },\r\n    samePlace() {\r\n      const list = []\r\n      for (let id of this.screen.target) {\r\n        const node = this.objectList[id]\r\n        if (node && node.parent?.valueOf() === this.screen.targetPlace) {\r\n          list.push(id)\r\n        }\r\n      }\r\n      return list\r\n    },\r\n    putEventsAtSamePlace(event) {\r\n      const list = this.samePlace()\r\n      for (let id of list)\r\n        this.screen.events[id] = event\r\n\r\n    },\r\n    putPlaceEvent(event) {\r\n      this.screen.events[this.objectNode.parent] = event\r\n    },\r\n    async putPlaceEvents(event) {\r\n      if (this.objectNode)\r\n        for (let p in this.objectNode.parents || {})\r\n          this.screen.events[p] = event\r\n      else\r\n        for (let p of this.object._parents) {\r\n          this.screen.events[new Place(this.object._name, p)] = event\r\n        }\r\n    },\r\n\r\n    removeEvent() {\r\n      this.screen.events = {}\r\n      // for (let id of this.screen.refs) {\r\n      //   this.screen.events[id] = 'ref'\r\n      // }\r\n    },\r\n    async remove() {\r\n      for (let id of this.screen.target) {\r\n        const object = await yin.get(id)\r\n        await object._delete()\r\n      }\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n\r\n    reference() {\r\n      this.screen.refs = this.screen.target\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async exportObject() {\r\n      const list = this.samePlace()\r\n      for (let id of list)\r\n        await this.parent[this.key.name].remove(id)\r\n      this.reference()\r\n    },\r\n    async makeCopy() {\r\n      const list = this.samePlace()\r\n      for (let id of list) {\r\n        try {\r\n          await this.parent[this.key.name].create(await yin.get(id))\r\n        }\r\n        catch (e) {\r\n        }\r\n      }\r\n    },\r\n    dashboard() {\r\n      window.open(`/#/dashboard/${this.screen.menu.target}`)\r\n      delete this.screen.menu\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.menu.target': 'init'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <yin-menu>\r\n    <template #target v-if=\"object._id\">\r\n      <p class=\"main\">\r\n        {{ object._title }}\r\n        <span style=\"font-size: smaller\">: {{ object._module.title }}</span>\r\n      </p>\r\n      <p v-if=\"screen.target.length>1\">... 等 {{ screen.target.length }}个对象</p>\r\n    </template>\r\n\r\n    <yin-menu-item @mouseover=\"putEvents('delete');putParentsEvents('delete')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"remove\">\r\n      <template #icon>\r\n        <DeleteOutlineFilled/>\r\n      </template>\r\n      删除\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEvents('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"reference\">\r\n      <template #icon>\r\n        <CopyAllFilled/>\r\n      </template>\r\n      引用（复制）\r\n      <template #info>\r\n        对象只是被引用到不同的位置\r\n      </template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"inArray\"\r\n                   @mouseover=\"putEventsAtSamePlace('update');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n    <yin-menu-item v-else\r\n                   @mouseover=\"putEvent('ref');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEventsAtSamePlace('read');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"makeCopy\">\r\n      <template #icon>\r\n        <ContentCopyFilled/>\r\n      </template>\r\n      创建副本\r\n      <template #info>\r\n        <span v-if=\"inArray\">为当前位置中被选中的对象创建副本</span>\r\n        <span v-else>*在当前位置创建副本以替换该对象</span>\r\n      </template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEvent('default')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"dashboard\">\r\n      <template #icon>\r\n        <DashboardRound/>\r\n      </template>\r\n      控制面板\r\n      <template #info>可分享给他人查看或编辑（须登录）</template>\r\n    </yin-menu-item>\r\n\r\n  </yin-menu>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin, Place} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport {DeleteOutlineFilled, CopyAllFilled, ContentCopyFilled, DashboardRound, ForkLeftFilled} from \"@vicons/material\";\r\nimport YinMenu from \"@/components/node/menu/yinMenu.vue\";\r\nimport YinMenuItem from \"@/components/node/menu/yinMenuItem.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinMenuObject\",\r\n  components: {\r\n    ForkLeftFilled,\r\n    YinMenuItem, YinMenu, DeleteOutlineFilled, CopyAllFilled, ContentCopyFilled, DashboardRound\r\n  },\r\n  props: ['screen', 'objectList', 'right'],\r\n  data() {\r\n    return {\r\n      object: {} as any,\r\n      parent: null,\r\n      key: null,\r\n      objectNode: null,\r\n      inArray: true\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      try {\r\n        this.object = await yin.get(this.screen.menu.target)\r\n        const node = this.objectList[this.screen.menu.target]\r\n        this.objectNode = node\r\n        if (node) {\r\n          this.parent = await yin.get(node.parent)\r\n          this.key = this.parent._schemaMix[node.parent.key]\r\n          this.inArray = this.key.type === 'Array'\r\n        }\r\n      }\r\n      catch (e) {\r\n        // console.log(e)\r\n      }\r\n    },\r\n    putEvent(event) {\r\n      this.screen.events[this.screen.menu.target] = event\r\n    },\r\n    putEvents(event) {\r\n      for (let id of this.screen.target) {\r\n        this.screen.events[id] = event\r\n      }\r\n    },\r\n    async putParentsEvents(event) {\r\n      for (let id of this.screen.target) {\r\n        const node = this.objectList[id]\r\n        if (node.parents)\r\n          for (let p in node.parents) {\r\n            this.screen.events[p] = event\r\n          }\r\n      }\r\n    },\r\n    samePlace() {\r\n      const list = []\r\n      for (let id of this.screen.target) {\r\n        const node = this.objectList[id]\r\n        if (node && node.parent?.valueOf() === this.screen.targetPlace) {\r\n          list.push(id)\r\n        }\r\n      }\r\n      return list\r\n    },\r\n    putEventsAtSamePlace(event) {\r\n      const list = this.samePlace()\r\n      for (let id of list)\r\n        this.screen.events[id] = event\r\n\r\n    },\r\n    putPlaceEvent(event) {\r\n      this.screen.events[this.objectNode.parent] = event\r\n    },\r\n    async putPlaceEvents(event) {\r\n      if (this.objectNode)\r\n        for (let p in this.objectNode.parents || {})\r\n          this.screen.events[p] = event\r\n      else\r\n        for (let p of this.object._parents) {\r\n          this.screen.events[new Place(this.object._name, p)] = event\r\n        }\r\n    },\r\n\r\n    removeEvent() {\r\n      this.screen.events = {}\r\n      // for (let id of this.screen.refs) {\r\n      //   this.screen.events[id] = 'ref'\r\n      // }\r\n    },\r\n    async remove() {\r\n      for (let id of this.screen.target) {\r\n        const object = await yin.get(id)\r\n        await object._delete()\r\n      }\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n\r\n    reference() {\r\n      this.screen.refs = this.screen.target\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async exportObject() {\r\n      const list = this.samePlace()\r\n      for (let id of list)\r\n        await this.parent[this.key.name].remove(id)\r\n      this.reference()\r\n    },\r\n    async makeCopy() {\r\n      const list = this.samePlace()\r\n      for (let id of list) {\r\n        try {\r\n          await this.parent[this.key.name].create(await yin.get(id))\r\n        }\r\n        catch (e) {\r\n        }\r\n      }\r\n    },\r\n    dashboard() {\r\n      window.open(`/#/dashboard/${this.screen.menu.target}`)\r\n      delete this.screen.menu\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.menu.target': 'init'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <yin-menu>\r\n    <template #target v-if=\"object._id\">\r\n      <p class=\"main\">\r\n        {{ object._title }}\r\n        <span style=\"font-size: smaller\">: {{ object._module.title }}</span>\r\n      </p>\r\n      <p v-if=\"screen.target.length>1\">... 等 {{ screen.target.length }}个对象</p>\r\n    </template>\r\n\r\n    <yin-menu-item @mouseover=\"putEvents('delete');putParentsEvents('delete')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"remove\">\r\n      <template #icon>\r\n        <DeleteOutlineFilled/>\r\n      </template>\r\n      删除\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEvents('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"reference\">\r\n      <template #icon>\r\n        <CopyAllFilled/>\r\n      </template>\r\n      引用（复制）\r\n      <template #info>\r\n        对象只是被引用到不同的位置\r\n      </template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"inArray\"\r\n                   @mouseover=\"putEventsAtSamePlace('update');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n    <yin-menu-item v-else\r\n                   @mouseover=\"putEvent('ref');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEventsAtSamePlace('read');putPlaceEvent('update')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"makeCopy\">\r\n      <template #icon>\r\n        <ContentCopyFilled/>\r\n      </template>\r\n      创建副本\r\n      <template #info>\r\n        <span v-if=\"inArray\">为当前位置中被选中的对象创建副本</span>\r\n        <span v-else>*在当前位置创建副本以替换该对象</span>\r\n      </template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item @mouseover=\"putEvent('default')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click.stop=\"dashboard\">\r\n      <template #icon>\r\n        <DashboardRound/>\r\n      </template>\r\n      控制面板\r\n      <template #info>可分享给他人查看或编辑（须登录）</template>\r\n    </yin-menu-item>\r\n\r\n  </yin-menu>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin, Place} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport {\r\n  DeleteOutlineFilled,\r\n  CopyAllFilled,\r\n  ContentCopyFilled,\r\n  DashboardRound,\r\n  ForkLeftFilled,\r\n  RampRightFilled,\r\n  AddCircleOutlineFilled\r\n} from \"@vicons/material\";\r\nimport YinMenu from \"@/components/node/menu/yinMenu.vue\";\r\nimport YinMenuItem from \"@/components/node/menu/yinMenuItem.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinMenuStructure\",\r\n  components: {\r\n    YinMenuItem,\r\n    YinMenu,\r\n    DeleteOutlineFilled,\r\n    CopyAllFilled,\r\n    ContentCopyFilled,\r\n    DashboardRound,\r\n    ForkLeftFilled,\r\n    RampRightFilled,\r\n    AddCircleOutlineFilled\r\n  },\r\n  props: ['screen', 'objectList', 'right'],\r\n  data() {\r\n    return {\r\n      parent: {},\r\n      key: {},\r\n      value: null,\r\n      models: []\r\n    }\r\n  },\r\n  computed: {\r\n    hasObject() {\r\n      return yin.structureType.indexOf(this.key.type) !== -1 && this.key.type !== 'Array' && this.value\r\n    },\r\n    hasRefs() {\r\n      return this.screen.refs?.length\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      try {\r\n        const place = new Place(this.screen.menu.target)\r\n        this.parent = await yin.get(this.screen.menu.target)\r\n        this.key = this.parent._schemaMix[place.key]\r\n        if (yin.structureType.indexOf(this.key.type) !== -1) {\r\n          try {\r\n            this.value = await this.parent[place.key]\r\n          }\r\n          catch (e) {\r\n            this.value = null\r\n          }\r\n          this.models = await this.parent[place.key].models()\r\n        }\r\n      }\r\n      catch (e) {\r\n       // console.log(e)\r\n      }\r\n    },\r\n    moduleTitle(key = this.key) {\r\n      if (['Object', 'Array'].includes(key.type))\r\n        return this.parent._module.title\r\n      return yin[key.type]?.title || key.type\r\n    },\r\n    putEvent(event) {\r\n      this.screen.events[this.screen.menu.target] = event\r\n    },\r\n    putChildEvent(event) {\r\n      this.screen.events[this.value._place.valueOf()] = event\r\n    },\r\n    putChildrenEvents(event) {\r\n\r\n    },\r\n    removeEvent() {\r\n      this.screen.events = {}\r\n    },\r\n    async removeChild() {\r\n      await this.value._delete()\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    referenceChild() {\r\n      this.screen.refs = [this.value._place.valueOf()]\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    reference() {\r\n      // this.screen.refs = this.screen.target\r\n      // delete this.screen.menu\r\n      // this.removeEvent()\r\n    },\r\n    async importObject() {\r\n      if (this.key.type === 'Array') for (let id of this.screen.refs) await this.parent[this.key.name].push(id)\r\n      else {\r\n        this.parent[this.key.name] = this.screen.refs[0]\r\n        await this.parent._save()\r\n      }\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    importHover() {\r\n      this.putEvent('update')\r\n      if (this.key.type === 'Array') {\r\n        for (let id of this.screen.refs) {\r\n          this.screen.events[id] = 'read'\r\n        }\r\n      }\r\n      else\r\n        this.screen.events[this.screen.refs[0]] = 'read'\r\n    },\r\n    async importCopyObject() {\r\n      if (this.key.type === 'Array') for (let id of this.screen.refs) await this.parent[this.key.name].create(await yin.get(id))\r\n      else await this.parent[this.key.name].create(await yin.get(this.screen.refs[0]))\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async exportObject() {\r\n      await this.parent[this.key.name].remove(this.value._id)\r\n      this.screen.refs = [this.value._place.valueOf()]\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async createObject(model?) {\r\n      if (model)\r\n        await this.parent[this.key.name].create({_model: model._id})\r\n      else\r\n        await this.parent[this.key.name].create()\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    dashboard() {\r\n      window.open(`/#/dashboard/${this.screen.menu.target}`)\r\n      delete this.screen.menu\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.menu.target': 'init'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <yin-menu>\r\n    <template #target>\r\n      <p class=\"main\">\r\n        {{ parent._title }}.{{ key.title }}\r\n        <span style=\"font-size: smaller\">: {{ moduleTitle(key) }}</span>\r\n      </p>\r\n      <p v-if=\"key.type==='Array'\">\r\n        共{{ value?.option?.total }}个对象\r\n      </p>\r\n      <p v-else-if=\"hasObject\">\r\n        {{ value._title }}\r\n      </p>\r\n      <p v-else>\r\n        未创建\r\n      </p>\r\n    </template>\r\n\r\n    <template v-if=\"hasObject\">\r\n      <yin-menu-item @mouseover=\"putEvent('delete');putChildEvent('delete')\" @mouseout=\"removeEvent\"\r\n                     @click=\"removeChild\">\r\n        <template #icon>\r\n          <DeleteOutlineFilled/>\r\n        </template>\r\n        删除 {{ value._title || value._place }}\r\n        <template #info>删除该位置的对象</template>\r\n      </yin-menu-item>\r\n\r\n      <yin-menu-item @mouseover=\"putChildEvent('ref')\" @mouseout=\"removeEvent\" @click=\"referenceChild\">\r\n        <template #icon>\r\n          <CopyAllFilled/>\r\n        </template>\r\n        引用 {{ value._title || value._place }}\r\n        <template #info>引用该位置的对象</template>\r\n      </yin-menu-item>\r\n      <hr>\r\n    </template>\r\n\r\n    <yin-menu-item @mouseover=\"putEvent('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"reference\">\r\n      <template #icon>\r\n        <CopyAllFilled/>\r\n      </template>\r\n      引用（复制）\r\n      <template #info>引用该位置</template>\r\n      <template #mate>开发中*</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasRefs\"\r\n                   @mouseover=\"importHover\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"importObject\">\r\n      <template #icon>\r\n        <RampRightFilled/>\r\n      </template>\r\n      引入（粘贴* | 映射 | 挂载）\r\n      <template #info>对象|位置 只是被引入到该位置,非复制</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasRefs\"\r\n                   @mouseover=\"importHover\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"importCopyObject\">\r\n      <template #icon>\r\n        <ContentCopyFilled/>\r\n      </template>\r\n      引入副本\r\n      <template #info>在该位置创建引用对象的副本</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasObject\"\r\n                   @mouseover=\"putEvent('update');putChildEvent('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item\r\n        @mouseover=\"putEvent('update')\"\r\n        @mouseout=\"removeEvent\"\r\n        @click=\"createObject()\">\r\n      <template #icon>\r\n        <AddCircleOutlineFilled/>\r\n      </template>\r\n      <span v-if=\"hasObject\">重新创建</span>\r\n      <span v-else>新建</span>\r\n      <template #info v-if=\"hasObject\">顶替现有对象 {{ value._title || value._place }}</template>\r\n      <template #mate v-if=\"parent._id\">\r\n        <span v-if=\"models.length>1\"> > </span>\r\n        <span v-else-if=\"models.length===1\">\r\n        {{ models[0]._title }}:{{ moduleTitle(key) }}\r\n        </span>\r\n        <span v-else>无模型{{ parent._module.title }}</span>\r\n      </template>\r\n      <template #children v-if=\"models.length>1\">\r\n        <yin-menu-item v-for=\"model in models\" @click.stop=\"createObject(model)\">\r\n          {{ model._title }}\r\n          <template #mate>:{{ moduleTitle(key) }}</template>\r\n        </yin-menu-item>\r\n      </template>\r\n    </yin-menu-item>\r\n  </yin-menu>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin, Place} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport {\r\n  DeleteOutlineFilled,\r\n  CopyAllFilled,\r\n  ContentCopyFilled,\r\n  DashboardRound,\r\n  ForkLeftFilled,\r\n  RampRightFilled,\r\n  AddCircleOutlineFilled\r\n} from \"@vicons/material\";\r\nimport YinMenu from \"@/components/node/menu/yinMenu.vue\";\r\nimport YinMenuItem from \"@/components/node/menu/yinMenuItem.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinMenuStructure\",\r\n  components: {\r\n    YinMenuItem,\r\n    YinMenu,\r\n    DeleteOutlineFilled,\r\n    CopyAllFilled,\r\n    ContentCopyFilled,\r\n    DashboardRound,\r\n    ForkLeftFilled,\r\n    RampRightFilled,\r\n    AddCircleOutlineFilled\r\n  },\r\n  props: ['screen', 'objectList', 'right'],\r\n  data() {\r\n    return {\r\n      parent: {},\r\n      key: {},\r\n      value: null,\r\n      models: []\r\n    }\r\n  },\r\n  computed: {\r\n    hasObject() {\r\n      return yin.structureType.indexOf(this.key.type) !== -1 && this.key.type !== 'Array' && this.value\r\n    },\r\n    hasRefs() {\r\n      return this.screen.refs?.length\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      try {\r\n        const place = new Place(this.screen.menu.target)\r\n        this.parent = await yin.get(this.screen.menu.target)\r\n        this.key = this.parent._schemaMix[place.key]\r\n        if (yin.structureType.indexOf(this.key.type) !== -1) {\r\n          try {\r\n            this.value = await this.parent[place.key]\r\n          }\r\n          catch (e) {\r\n            this.value = null\r\n          }\r\n          this.models = await this.parent[place.key].models()\r\n        }\r\n      }\r\n      catch (e) {\r\n       // console.log(e)\r\n      }\r\n    },\r\n    moduleTitle(key = this.key) {\r\n      if (['Object', 'Array'].includes(key.type))\r\n        return this.parent._module.title\r\n      return yin[key.type]?.title || key.type\r\n    },\r\n    putEvent(event) {\r\n      this.screen.events[this.screen.menu.target] = event\r\n    },\r\n    putChildEvent(event) {\r\n      this.screen.events[this.value._place.valueOf()] = event\r\n    },\r\n    putChildrenEvents(event) {\r\n\r\n    },\r\n    removeEvent() {\r\n      this.screen.events = {}\r\n    },\r\n    async removeChild() {\r\n      await this.value._delete()\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    referenceChild() {\r\n      this.screen.refs = [this.value._place.valueOf()]\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    reference() {\r\n      // this.screen.refs = this.screen.target\r\n      // delete this.screen.menu\r\n      // this.removeEvent()\r\n    },\r\n    async importObject() {\r\n      if (this.key.type === 'Array') for (let id of this.screen.refs) await this.parent[this.key.name].push(id)\r\n      else {\r\n        this.parent[this.key.name] = this.screen.refs[0]\r\n        await this.parent._save()\r\n      }\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    importHover() {\r\n      this.putEvent('update')\r\n      if (this.key.type === 'Array') {\r\n        for (let id of this.screen.refs) {\r\n          this.screen.events[id] = 'read'\r\n        }\r\n      }\r\n      else\r\n        this.screen.events[this.screen.refs[0]] = 'read'\r\n    },\r\n    async importCopyObject() {\r\n      if (this.key.type === 'Array') for (let id of this.screen.refs) await this.parent[this.key.name].create(await yin.get(id))\r\n      else await this.parent[this.key.name].create(await yin.get(this.screen.refs[0]))\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async exportObject() {\r\n      await this.parent[this.key.name].remove(this.value._id)\r\n      this.screen.refs = [this.value._place.valueOf()]\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    async createObject(model?) {\r\n      if (model)\r\n        await this.parent[this.key.name].create({_model: model._id})\r\n      else\r\n        await this.parent[this.key.name].create()\r\n      delete this.screen.menu\r\n      this.removeEvent()\r\n    },\r\n    dashboard() {\r\n      window.open(`/#/dashboard/${this.screen.menu.target}`)\r\n      delete this.screen.menu\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.menu.target': 'init'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <yin-menu>\r\n    <template #target>\r\n      <p class=\"main\">\r\n        {{ parent._title }}.{{ key.title }}\r\n        <span style=\"font-size: smaller\">: {{ moduleTitle(key) }}</span>\r\n      </p>\r\n      <p v-if=\"key.type==='Array'\">\r\n        共{{ value?.option?.total }}个对象\r\n      </p>\r\n      <p v-else-if=\"hasObject\">\r\n        {{ value._title }}\r\n      </p>\r\n      <p v-else>\r\n        未创建\r\n      </p>\r\n    </template>\r\n\r\n    <template v-if=\"hasObject\">\r\n      <yin-menu-item @mouseover=\"putEvent('delete');putChildEvent('delete')\" @mouseout=\"removeEvent\"\r\n                     @click=\"removeChild\">\r\n        <template #icon>\r\n          <DeleteOutlineFilled/>\r\n        </template>\r\n        删除 {{ value._title || value._place }}\r\n        <template #info>删除该位置的对象</template>\r\n      </yin-menu-item>\r\n\r\n      <yin-menu-item @mouseover=\"putChildEvent('ref')\" @mouseout=\"removeEvent\" @click=\"referenceChild\">\r\n        <template #icon>\r\n          <CopyAllFilled/>\r\n        </template>\r\n        引用 {{ value._title || value._place }}\r\n        <template #info>引用该位置的对象</template>\r\n      </yin-menu-item>\r\n      <hr>\r\n    </template>\r\n\r\n    <yin-menu-item @mouseover=\"putEvent('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"reference\">\r\n      <template #icon>\r\n        <CopyAllFilled/>\r\n      </template>\r\n      引用（复制）\r\n      <template #info>引用该位置</template>\r\n      <template #mate>开发中*</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasRefs\"\r\n                   @mouseover=\"importHover\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"importObject\">\r\n      <template #icon>\r\n        <RampRightFilled/>\r\n      </template>\r\n      引入（粘贴* | 映射 | 挂载）\r\n      <template #info>对象|位置 只是被引入到该位置,非复制</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasRefs\"\r\n                   @mouseover=\"importHover\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"importCopyObject\">\r\n      <template #icon>\r\n        <ContentCopyFilled/>\r\n      </template>\r\n      引入副本\r\n      <template #info>在该位置创建引用对象的副本</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item v-if=\"hasObject\"\r\n                   @mouseover=\"putEvent('update');putChildEvent('ref')\"\r\n                   @mouseout=\"removeEvent\"\r\n                   @click=\"exportObject\">\r\n      <template #icon>\r\n        <ForkLeftFilled/>\r\n      </template>\r\n      引出（剪切）\r\n      <template #info>对象|位置 只是不再被引入到该位置</template>\r\n    </yin-menu-item>\r\n\r\n    <yin-menu-item\r\n        @mouseover=\"putEvent('update')\"\r\n        @mouseout=\"removeEvent\"\r\n        @click=\"createObject()\">\r\n      <template #icon>\r\n        <AddCircleOutlineFilled/>\r\n      </template>\r\n      <span v-if=\"hasObject\">重新创建</span>\r\n      <span v-else>新建</span>\r\n      <template #info v-if=\"hasObject\">顶替现有对象 {{ value._title || value._place }}</template>\r\n      <template #mate v-if=\"parent._id\">\r\n        <span v-if=\"models.length>1\"> > </span>\r\n        <span v-else-if=\"models.length===1\">\r\n        {{ models[0]._title }}:{{ moduleTitle(key) }}\r\n        </span>\r\n        <span v-else>无模型{{ parent._module.title }}</span>\r\n      </template>\r\n      <template #children v-if=\"models.length>1\">\r\n        <yin-menu-item v-for=\"model in models\" @click.stop=\"createObject(model)\">\r\n          {{ model._title }}\r\n          <template #mate>:{{ moduleTitle(key) }}</template>\r\n        </yin-menu-item>\r\n      </template>\r\n    </yin-menu-item>\r\n  </yin-menu>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin} from 'yin-core-client'\r\nimport {useNotification} from 'naive-ui'\r\nimport {defineComponent} from 'vue'\r\nimport {UploadOutlined} from \"@vicons/material\";\r\n\r\n\r\nexport default defineComponent({\r\n  name: \"saveAll\",\r\n  components: {UploadOutlined},\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      msg: '',\r\n      message: useNotification()\r\n    }\r\n  },\r\n  methods: {\r\n    async save() {\r\n      this.loading = true\r\n      try {\r\n        const list = await yin.saveAll((i, all, changed, object) => {\r\n          this.msg = (changed ? '保存' : '扫描') + ` : ${object._title} #${object._place} - ${i}/${all}`\r\n        })\r\n\r\n        if (list.length)\r\n          this.message.success({\r\n            title: `${list.length}个成功保存`,\r\n            duration: 3000\r\n          })\r\n        else\r\n          this.message.warning({\r\n            title: '没有未保存的对象',\r\n            duration: 2000\r\n          })\r\n\r\n      }\r\n      catch (e) {\r\n        this.message.error({\r\n          title: `${e.err.length}个未成功保存`,\r\n          content: `${e.list.length}个成功保存`,\r\n          // meta: e.err,\r\n          duration: 2500,\r\n          keepAliveOnHover: true\r\n        })\r\n      }\r\n\r\n      this.loading = false\r\n    }\r\n  },\r\n})\r\n</script>\r\n\r\n<template>\r\n  <n-button @click=\"save\" :loading=\"loading\">\r\n    <!--    <n-icon size=\"21\">-->\r\n    <!--      <UploadOutlined/>-->\r\n    <!--    </n-icon>-->\r\n    <p v-if=\"loading\">{{ msg }}</p>\r\n    <p v-else>保存</p>\r\n  </n-button>\r\n</template>\r\n\r\n<!--<style scoped lang=\"less\">-->\r\n<!--p {-->\r\n<!--  margin-left: 5px;-->\r\n<!--}-->\r\n<!--</style>-->\r\n","<script lang=\"ts\">\r\nimport {yin} from 'yin-core-client'\r\nimport {useNotification} from 'naive-ui'\r\nimport {defineComponent} from 'vue'\r\nimport {UploadOutlined} from \"@vicons/material\";\r\n\r\n\r\nexport default defineComponent({\r\n  name: \"saveAll\",\r\n  components: {UploadOutlined},\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      msg: '',\r\n      message: useNotification()\r\n    }\r\n  },\r\n  methods: {\r\n    async save() {\r\n      this.loading = true\r\n      try {\r\n        const list = await yin.saveAll((i, all, changed, object) => {\r\n          this.msg = (changed ? '保存' : '扫描') + ` : ${object._title} #${object._place} - ${i}/${all}`\r\n        })\r\n\r\n        if (list.length)\r\n          this.message.success({\r\n            title: `${list.length}个成功保存`,\r\n            duration: 3000\r\n          })\r\n        else\r\n          this.message.warning({\r\n            title: '没有未保存的对象',\r\n            duration: 2000\r\n          })\r\n\r\n      }\r\n      catch (e) {\r\n        this.message.error({\r\n          title: `${e.err.length}个未成功保存`,\r\n          content: `${e.list.length}个成功保存`,\r\n          // meta: e.err,\r\n          duration: 2500,\r\n          keepAliveOnHover: true\r\n        })\r\n      }\r\n\r\n      this.loading = false\r\n    }\r\n  },\r\n})\r\n</script>\r\n\r\n<template>\r\n  <n-button @click=\"save\" :loading=\"loading\">\r\n    <!--    <n-icon size=\"21\">-->\r\n    <!--      <UploadOutlined/>-->\r\n    <!--    </n-icon>-->\r\n    <p v-if=\"loading\">{{ msg }}</p>\r\n    <p v-else>保存</p>\r\n  </n-button>\r\n</template>\r\n\r\n<!--<style scoped lang=\"less\">-->\r\n<!--p {-->\r\n<!--  margin-left: 5px;-->\r\n<!--}-->\r\n<!--</style>-->\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\n\r\nexport default defineComponent({\r\n  name: \"tinyRadio\",\r\n  props: ['modelValue', 'values', 'names']\r\n})\r\n</script>\r\n\r\n<template>\r\n  <n-button-group>\r\n    <n-button size=\"tiny\" secondary v-for=\"(value,i) in values\"\r\n              :type=\"(modelValue===value)?'primary':'default'\"\r\n              @click=\"$emit('update:modelValue',value)\">\r\n      {{ names && names[i] || value }}\r\n    </n-button>\r\n  </n-button-group>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\n\r\nexport default defineComponent({\r\n  name: \"tinyRadio\",\r\n  props: ['modelValue', 'values', 'names']\r\n})\r\n</script>\r\n\r\n<template>\r\n  <n-button-group>\r\n    <n-button size=\"tiny\" secondary v-for=\"(value,i) in values\"\r\n              :type=\"(modelValue===value)?'primary':'default'\"\r\n              @click=\"$emit('update:modelValue',value)\">\r\n      {{ names && names[i] || value }}\r\n    </n-button>\r\n  </n-button-group>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport InputSchemaLite from \"@/components/editor/inputLite/inputSchemaLite.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"dialogSchema\",\r\n  components: {InputSchemaLite},\r\n  props: ['object', 'target'],\r\n  data() {\r\n    return {\r\n      pre: '',\r\n      after: '',\r\n      msg: ''\r\n    }\r\n  },\r\n  methods: {\r\n    makeContent() {\r\n      // console.log(this.object.content)\r\n      if (this.object.content) {\r\n        let res = []\r\n        if (this.object.content.match(/(\\|.+\\|.+\\|.+\\|.+\\|)+/g)) {\r\n          this.msg = ''\r\n          res = this.object.content.split(/\\|.+\\|.+\\|.+\\|.+\\|/)\r\n        }\r\n        else if (this.object.content.match(/(.+\\|.+\\|.+\\|.+)+/g)) {\r\n          res = this.object.content.split(/.+\\|.+\\|.+\\|.+/)\r\n          this.msg = '此生成存在问题，请注意使用'\r\n        }\r\n        else\r\n          this.msg = '未生成出可使用内容。。。'\r\n\r\n        if (res.length) {\r\n          this.pre = res[0]\r\n          this.after = res[res.length - 1]\r\n        }\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    _makeContent() {\r\n      if (this.object.content) {\r\n        try {\r\n          JSON.parse(this.object.content)\r\n          this.pre = ''\r\n          this.after = ''\r\n        }\r\n        catch (e) {\r\n          this.pre = this.object.content.replace(/```json[\\s\\S]+/, '')\r\n          if (/```json[\\s\\S]+```/.test(this.object.content))\r\n            this.after = this.object.content.replace(/[\\s\\S]+```/, '')\r\n        }\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    async apply() {\r\n      this.target._schema = []\r\n      this.target._schema = this.object.result\r\n      await this.target._save()\r\n    }\r\n  },\r\n  watch: {\r\n    'object.content'() {\r\n      this.makeContent()\r\n      this.$emit('update')\r\n    }\r\n  },\r\n  mounted() {\r\n    this.makeContent()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"dialog\">\r\n    <div class=\"text\">{{ pre }}</div>\r\n    <input-schema-lite :model-value=\"{_schema:this.object.result}\" v-if=\"this.object.result instanceof Array\"/>\r\n    <div class=\"text\">{{ after }}</div>\r\n    {{ msg }}\r\n    <div class=\"fns\">\r\n      <n-button v-if=\"this.object.result&&this.object.result.length\" @click=\"apply\">应用</n-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.dialog {\r\n  .text {\r\n    white-space: pre-wrap;\r\n  }\r\n\r\n  .fns {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n}\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport InputSchemaLite from \"@/components/editor/inputLite/inputSchemaLite.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"dialogSchema\",\r\n  components: {InputSchemaLite},\r\n  props: ['object', 'target'],\r\n  data() {\r\n    return {\r\n      pre: '',\r\n      after: '',\r\n      msg: ''\r\n    }\r\n  },\r\n  methods: {\r\n    makeContent() {\r\n      // console.log(this.object.content)\r\n      if (this.object.content) {\r\n        let res = []\r\n        if (this.object.content.match(/(\\|.+\\|.+\\|.+\\|.+\\|)+/g)) {\r\n          this.msg = ''\r\n          res = this.object.content.split(/\\|.+\\|.+\\|.+\\|.+\\|/)\r\n        }\r\n        else if (this.object.content.match(/(.+\\|.+\\|.+\\|.+)+/g)) {\r\n          res = this.object.content.split(/.+\\|.+\\|.+\\|.+/)\r\n          this.msg = '此生成存在问题，请注意使用'\r\n        }\r\n        else\r\n          this.msg = '未生成出可使用内容。。。'\r\n\r\n        if (res.length) {\r\n          this.pre = res[0]\r\n          this.after = res[res.length - 1]\r\n        }\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    _makeContent() {\r\n      if (this.object.content) {\r\n        try {\r\n          JSON.parse(this.object.content)\r\n          this.pre = ''\r\n          this.after = ''\r\n        }\r\n        catch (e) {\r\n          this.pre = this.object.content.replace(/```json[\\s\\S]+/, '')\r\n          if (/```json[\\s\\S]+```/.test(this.object.content))\r\n            this.after = this.object.content.replace(/[\\s\\S]+```/, '')\r\n        }\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    async apply() {\r\n      this.target._schema = []\r\n      this.target._schema = this.object.result\r\n      await this.target._save()\r\n    }\r\n  },\r\n  watch: {\r\n    'object.content'() {\r\n      this.makeContent()\r\n      this.$emit('update')\r\n    }\r\n  },\r\n  mounted() {\r\n    this.makeContent()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"dialog\">\r\n    <div class=\"text\">{{ pre }}</div>\r\n    <input-schema-lite :model-value=\"{_schema:this.object.result}\" v-if=\"this.object.result instanceof Array\"/>\r\n    <div class=\"text\">{{ after }}</div>\r\n    {{ msg }}\r\n    <div class=\"fns\">\r\n      <n-button v-if=\"this.object.result&&this.object.result.length\" @click=\"apply\">应用</n-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.dialog {\r\n  .text {\r\n    white-space: pre-wrap;\r\n  }\r\n\r\n  .fns {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n}\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport CodeJavaScript from \"@/components/editor/code/codeJavaScript.vue\";\r\n\r\n\r\nexport default defineComponent({\r\n  name: \"dialogScript\",\r\n  components: {CodeJavaScript},\r\n  props: ['object', 'target'],\r\n  data() {\r\n    return {\r\n      list: []\r\n    }\r\n  },\r\n  methods: {\r\n    makeContent() {\r\n      if (this.object.content) {\r\n        this.list = []\r\n        const blockMatch = this.object.content.match(/```[\\s\\S]*?```\\s?/g)\r\n        if (blockMatch) {\r\n          const blockList = blockMatch.map(value => value.match(/```javascript\\n([\\s\\S]*?)\\n```\\s?/)[1]),\r\n              textMatch = this.object.content.split(/```[\\s\\S]*?```\\s?/)\r\n          let blockFirst = false\r\n          for (let i in textMatch) {\r\n            const text = textMatch[i]\r\n            if (i === '0' && text === '') blockFirst = true\r\n            if (blockFirst)\r\n              this.list.push({type: 'block', content: blockList[i]}, {type: 'text', content: text})\r\n            else\r\n              this.list.push({type: 'text', content: text}, {type: 'block', content: blockList[i]})\r\n          }\r\n          if (JSON.stringify(textMatch) !== `[\"\",\"\"]` && textMatch[textMatch.length - 1] === '')\r\n            this.list.push({type: 'block', content: blockList[blockList.length - 1]})\r\n        }\r\n        else\r\n          this.list = [{type: 'text', content: this.object.content}]\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    async apply(script) {\r\n      try {\r\n        await yin.readScript(this.target._place);\r\n        await yin.updateScript(this.target._place, script)\r\n      }\r\n      catch (e) {\r\n        await yin.createScript(this.target._place, script)\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    'object.content'() {\r\n      this.makeContent()\r\n      this.$emit('update')\r\n    }\r\n  },\r\n  mounted() {\r\n    this.makeContent()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"dialog\">\r\n    <template v-for=\"block in list\">\r\n      <template v-if=\"block.content\">\r\n        <div class=\"text\" v-if=\"block.type==='text'\">{{ block.content }}</div>\r\n        <div class=\"code\" v-else>\r\n          <code-java-script v-model=\"block.content\"/>\r\n          <n-button class=\"fn\" @click=\"apply(block.content)\">应用</n-button>\r\n        </div>\r\n      </template>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.dialog {\r\n  .text {\r\n    white-space: pre-wrap;\r\n  }\r\n\r\n  .code {\r\n    position: relative;\r\n\r\n    .fn {\r\n      position: absolute;\r\n      bottom: 8px;\r\n      right: 6px;\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {yin} from 'yin-core-client'\r\nimport {defineComponent} from 'vue'\r\nimport CodeJavaScript from \"@/components/editor/code/codeJavaScript.vue\";\r\n\r\n\r\nexport default defineComponent({\r\n  name: \"dialogScript\",\r\n  components: {CodeJavaScript},\r\n  props: ['object', 'target'],\r\n  data() {\r\n    return {\r\n      list: []\r\n    }\r\n  },\r\n  methods: {\r\n    makeContent() {\r\n      if (this.object.content) {\r\n        this.list = []\r\n        const blockMatch = this.object.content.match(/```[\\s\\S]*?```\\s?/g)\r\n        if (blockMatch) {\r\n          const blockList = blockMatch.map(value => value.match(/```javascript\\n([\\s\\S]*?)\\n```\\s?/)[1]),\r\n              textMatch = this.object.content.split(/```[\\s\\S]*?```\\s?/)\r\n          let blockFirst = false\r\n          for (let i in textMatch) {\r\n            const text = textMatch[i]\r\n            if (i === '0' && text === '') blockFirst = true\r\n            if (blockFirst)\r\n              this.list.push({type: 'block', content: blockList[i]}, {type: 'text', content: text})\r\n            else\r\n              this.list.push({type: 'text', content: text}, {type: 'block', content: blockList[i]})\r\n          }\r\n          if (JSON.stringify(textMatch) !== `[\"\",\"\"]` && textMatch[textMatch.length - 1] === '')\r\n            this.list.push({type: 'block', content: blockList[blockList.length - 1]})\r\n        }\r\n        else\r\n          this.list = [{type: 'text', content: this.object.content}]\r\n      }\r\n      else\r\n        this.pre = '生成中...'\r\n    },\r\n    async apply(script) {\r\n      try {\r\n        await yin.readScript(this.target._place);\r\n        await yin.updateScript(this.target._place, script)\r\n      }\r\n      catch (e) {\r\n        await yin.createScript(this.target._place, script)\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    'object.content'() {\r\n      this.makeContent()\r\n      this.$emit('update')\r\n    }\r\n  },\r\n  mounted() {\r\n    this.makeContent()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"dialog\">\r\n    <template v-for=\"block in list\">\r\n      <template v-if=\"block.content\">\r\n        <div class=\"text\" v-if=\"block.type==='text'\">{{ block.content }}</div>\r\n        <div class=\"code\" v-else>\r\n          <code-java-script v-model=\"block.content\"/>\r\n          <n-button class=\"fn\" @click=\"apply(block.content)\">应用</n-button>\r\n        </div>\r\n      </template>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.dialog {\r\n  .text {\r\n    white-space: pre-wrap;\r\n  }\r\n\r\n  .code {\r\n    position: relative;\r\n\r\n    .fn {\r\n      position: absolute;\r\n      bottom: 8px;\r\n      right: 6px;\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport {yin, yinCab} from 'yin-core-client'\r\nimport TinyRadio from \"@/components/editor/tinyRadio.vue\";\r\nimport DialogSchema from \"@/components/node/chat/dialogSchema.vue\";\r\nimport DialogScript from \"@/components/node/chat/dialogScript.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinBigModel\",\r\n  components: {DialogScript, DialogSchema, TinyRadio},\r\n  inject: ['screen'],\r\n  data() {\r\n    return {\r\n      object: {},\r\n      chat: {},\r\n      chatList: [],\r\n      fn: '_schema',\r\n      commandNow: '',\r\n      scrollTimer: ''\r\n    }\r\n  },\r\n  computed: {\r\n    chatPlace() {\r\n      return this.object._place?.toKey(this.fn)\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      this.object = {}\r\n      if (this.screen.target[0]) {\r\n        this.object = await yin.get(this.screen.target[0])\r\n        await this.initChat()\r\n      }\r\n      else {\r\n        this.chat = {}\r\n        this.chatList = []\r\n      }\r\n    },\r\n    async initChat() {\r\n      this.chat = {}\r\n      this.chatList = []\r\n      try {\r\n        this.chat = await yinCab.Command.findOne({_bindPlace: this.chatPlace})\r\n      }\r\n      catch (e) {\r\n        this.chat = await yinCab.Command.create({\r\n          _bindPlace: this.chatPlace,\r\n          _bindInstance: yin.system.instance,\r\n          _model: '6528fac4e00c64cc97010db6',\r\n          reference: {}\r\n        })\r\n      }\r\n      switch (this.fn) {\r\n        case \"_schema\":\r\n          this.chat.info = this.object._schema\r\n          break\r\n        case 'script':\r\n          const info = {schema: this.object._schemaMix, script: ''}\r\n          try {\r\n            info.script = await yin.readScript(this.object._place)\r\n          }\r\n          catch (e) {\r\n\r\n          }\r\n          this.chat.info = info\r\n          break\r\n      }\r\n      await this.chat._save()\r\n      this.chatList = await this.chat.commands\r\n      await this.chatList.all()\r\n      this.$refs.view.scrollTop = this.$refs.view.scrollHeight\r\n    },\r\n    async command() {\r\n      await this.chat.commands.create({content: this.commandNow, isCommand: true})\r\n      this.commandNow = ''\r\n      setTimeout(() => {\r\n        this.scrollBottom()\r\n      }, 1000)\r\n    },\r\n    scrollBottom() {\r\n      this.$refs.view.scroll({top: this.$refs.view.scrollHeight, behavior: 'smooth'})\r\n    },\r\n    async clearChat() {\r\n      await this.chat._delete()\r\n      this.chat = {}\r\n      this.chatList = []\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.target'(v, _v) {\r\n      if (v[0] !== _v[0])\r\n        this.init()\r\n    },\r\n    'fn': 'initChat'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n    // this.scrollTimer = setInterval(() => {\r\n    //   this.scrollBottom()\r\n    // }, 1000)\r\n  },\r\n  // beforeUnmount() {\r\n  //   clearInterval(this.scrollTimer)\r\n  // }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"yinBigModel\">\r\n    <div class=\"mainBox\" v-if=\"object._id\">\r\n      <p class=\"title\">{{ object._title }}：<span>{{ object._module.title }}</span></p>\r\n      <tiny-radio v-model=\"fn\" :values=\"['_schema','script']\" :names=\"['结构','脚本']\"/>\r\n    </div>\r\n    <div class=\"mainBox\" v-else-if=\"this.screen.target[0]\">\r\n      <p>{{ this.screen.target[0] }}：<span>载入中</span></p>\r\n    </div>\r\n    <div class=\"mainBox\" v-else>\r\n      <p>请至少选中一个对象</p>\r\n    </div>\r\n    <div class=\"commandLine\" ref=\"view\">\r\n      <template v-for=\"c in chatList\">\r\n        <div class=\"command\" v-if=\"c.isCommand\">\r\n          <div class=\"dialog\">\r\n            {{ c.content }}\r\n          </div>\r\n        </div>\r\n        <div class=\"response \" v-else>\r\n          <dialog-schema v-if=\"fn==='_schema'\" :object=\"c\" :target=\"object\" @update=\"scrollBottom\"/>\r\n          <dialog-script v-else-if=\"fn==='script'\" :object=\"c\" :target=\"object\" @update=\"scrollBottom\"/>\r\n          <div class=\"dialog\" v-else>\r\n            {{ c.content }}\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <p class=\"msg\" style=\"cursor: pointer\" @click=\"clearChat\" v-if=\"chatList.length\">清空内容</p>\r\n      <p class=\"msg\" v-else>当前对话为空</p>\r\n\r\n    </div>\r\n    <div class=\"commandInput\">\r\n      <n-input placeholder=\"回车发送指令\" type=\"textarea\" :autosize=\"{minRows:1}\" v-model:value=\"commandNow\"\r\n               @keyup.enter=\"command\"/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.yinBigModel {\r\n\r\n  & > * {\r\n    padding: 13px;\r\n  }\r\n\r\n  .mainBox {\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    border-bottom: var(--border);\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: flex-end;\r\n\r\n    p {\r\n      span {\r\n        font-size: smaller;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  .commandLine {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 50px;\r\n    bottom: 0;\r\n    padding-bottom: 88px;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n    box-sizing: border-box;\r\n\r\n    &::-webkit-scrollbar {\r\n      display: none;\r\n    }\r\n\r\n    .dialog {\r\n      border: var(--border);\r\n      border-radius: var(--border-radius);\r\n      margin-bottom: 13px;\r\n      max-width: 90%;\r\n      box-sizing: border-box;\r\n      padding: 13px;\r\n    }\r\n\r\n    .command {\r\n      display: flex;\r\n      justify-content: flex-end;\r\n    }\r\n\r\n\r\n    .response {\r\n      display: flex;\r\n    }\r\n\r\n    .msg {\r\n      margin-top: 21px;\r\n      opacity: 0.6;\r\n      font-size: small;\r\n      text-align: center;\r\n      cursor: default;\r\n    }\r\n  }\r\n\r\n  .commandInput {\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    bottom: 0;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport {yin, yinCab} from 'yin-core-client'\r\nimport TinyRadio from \"@/components/editor/tinyRadio.vue\";\r\nimport DialogSchema from \"@/components/node/chat/dialogSchema.vue\";\r\nimport DialogScript from \"@/components/node/chat/dialogScript.vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinBigModel\",\r\n  components: {DialogScript, DialogSchema, TinyRadio},\r\n  inject: ['screen'],\r\n  data() {\r\n    return {\r\n      object: {},\r\n      chat: {},\r\n      chatList: [],\r\n      fn: '_schema',\r\n      commandNow: '',\r\n      scrollTimer: ''\r\n    }\r\n  },\r\n  computed: {\r\n    chatPlace() {\r\n      return this.object._place?.toKey(this.fn)\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      this.object = {}\r\n      if (this.screen.target[0]) {\r\n        this.object = await yin.get(this.screen.target[0])\r\n        await this.initChat()\r\n      }\r\n      else {\r\n        this.chat = {}\r\n        this.chatList = []\r\n      }\r\n    },\r\n    async initChat() {\r\n      this.chat = {}\r\n      this.chatList = []\r\n      try {\r\n        this.chat = await yinCab.Command.findOne({_bindPlace: this.chatPlace})\r\n      }\r\n      catch (e) {\r\n        this.chat = await yinCab.Command.create({\r\n          _bindPlace: this.chatPlace,\r\n          _bindInstance: yin.system.instance,\r\n          _model: '6528fac4e00c64cc97010db6',\r\n          reference: {}\r\n        })\r\n      }\r\n      switch (this.fn) {\r\n        case \"_schema\":\r\n          this.chat.info = this.object._schema\r\n          break\r\n        case 'script':\r\n          const info = {schema: this.object._schemaMix, script: ''}\r\n          try {\r\n            info.script = await yin.readScript(this.object._place)\r\n          }\r\n          catch (e) {\r\n\r\n          }\r\n          this.chat.info = info\r\n          break\r\n      }\r\n      await this.chat._save()\r\n      this.chatList = await this.chat.commands\r\n      await this.chatList.all()\r\n      this.$refs.view.scrollTop = this.$refs.view.scrollHeight\r\n    },\r\n    async command() {\r\n      await this.chat.commands.create({content: this.commandNow, isCommand: true})\r\n      this.commandNow = ''\r\n      setTimeout(() => {\r\n        this.scrollBottom()\r\n      }, 1000)\r\n    },\r\n    scrollBottom() {\r\n      this.$refs.view.scroll({top: this.$refs.view.scrollHeight, behavior: 'smooth'})\r\n    },\r\n    async clearChat() {\r\n      await this.chat._delete()\r\n      this.chat = {}\r\n      this.chatList = []\r\n    }\r\n  },\r\n  watch: {\r\n    'screen.target'(v, _v) {\r\n      if (v[0] !== _v[0])\r\n        this.init()\r\n    },\r\n    'fn': 'initChat'\r\n  },\r\n  mounted() {\r\n    this.init()\r\n    // this.scrollTimer = setInterval(() => {\r\n    //   this.scrollBottom()\r\n    // }, 1000)\r\n  },\r\n  // beforeUnmount() {\r\n  //   clearInterval(this.scrollTimer)\r\n  // }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"yinBigModel\">\r\n    <div class=\"mainBox\" v-if=\"object._id\">\r\n      <p class=\"title\">{{ object._title }}：<span>{{ object._module.title }}</span></p>\r\n      <tiny-radio v-model=\"fn\" :values=\"['_schema','script']\" :names=\"['结构','脚本']\"/>\r\n    </div>\r\n    <div class=\"mainBox\" v-else-if=\"this.screen.target[0]\">\r\n      <p>{{ this.screen.target[0] }}：<span>载入中</span></p>\r\n    </div>\r\n    <div class=\"mainBox\" v-else>\r\n      <p>请至少选中一个对象</p>\r\n    </div>\r\n    <div class=\"commandLine\" ref=\"view\">\r\n      <template v-for=\"c in chatList\">\r\n        <div class=\"command\" v-if=\"c.isCommand\">\r\n          <div class=\"dialog\">\r\n            {{ c.content }}\r\n          </div>\r\n        </div>\r\n        <div class=\"response \" v-else>\r\n          <dialog-schema v-if=\"fn==='_schema'\" :object=\"c\" :target=\"object\" @update=\"scrollBottom\"/>\r\n          <dialog-script v-else-if=\"fn==='script'\" :object=\"c\" :target=\"object\" @update=\"scrollBottom\"/>\r\n          <div class=\"dialog\" v-else>\r\n            {{ c.content }}\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <p class=\"msg\" style=\"cursor: pointer\" @click=\"clearChat\" v-if=\"chatList.length\">清空内容</p>\r\n      <p class=\"msg\" v-else>当前对话为空</p>\r\n\r\n    </div>\r\n    <div class=\"commandInput\">\r\n      <n-input placeholder=\"回车发送指令\" type=\"textarea\" :autosize=\"{minRows:1}\" v-model:value=\"commandNow\"\r\n               @keyup.enter=\"command\"/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.yinBigModel {\r\n\r\n  & > * {\r\n    padding: 13px;\r\n  }\r\n\r\n  .mainBox {\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    border-bottom: var(--border);\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: flex-end;\r\n\r\n    p {\r\n      span {\r\n        font-size: smaller;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  .commandLine {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 50px;\r\n    bottom: 0;\r\n    padding-bottom: 88px;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n    box-sizing: border-box;\r\n\r\n    &::-webkit-scrollbar {\r\n      display: none;\r\n    }\r\n\r\n    .dialog {\r\n      border: var(--border);\r\n      border-radius: var(--border-radius);\r\n      margin-bottom: 13px;\r\n      max-width: 90%;\r\n      box-sizing: border-box;\r\n      padding: 13px;\r\n    }\r\n\r\n    .command {\r\n      display: flex;\r\n      justify-content: flex-end;\r\n    }\r\n\r\n\r\n    .response {\r\n      display: flex;\r\n    }\r\n\r\n    .msg {\r\n      margin-top: 21px;\r\n      opacity: 0.6;\r\n      font-size: small;\r\n      text-align: center;\r\n      cursor: default;\r\n    }\r\n  }\r\n\r\n  .commandInput {\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    bottom: 0;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport {yin} from 'yin-core-client'\r\nimport {NButton, NFormItemRow, NInput, NInputGroup, NTabPane, NTabs, useNotification} from \"naive-ui\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinAuth\",\r\n  components: {NFormItemRow, NInputGroup, NButton, NTabs, NInput, NTabPane},\r\n  props: ['yinCore'],\r\n  data() {\r\n    return {\r\n      message: useNotification(),\r\n      _tel: '',\r\n      code: '',\r\n      _password: '',\r\n      confirmPassword: '',\r\n      device: '',\r\n      msg: '',\r\n      time: 60,\r\n      yin\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.yinCore) this.yin = this.yinCore\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"yinAuth\">\r\n    <h3>{{ yin.system.title }}</h3>\r\n    <template v-if=\"yin.system.uninitialized\">\r\n      <n-h4>初始化</n-h4>\r\n      <p>此时注册的用户将为管理员</p>\r\n    </template>\r\n    <n-tabs default-value=\"password\" size=\"large\">\r\n      <n-tab-pane name=\"password\" tab=\"密码\">\r\n        <n-form-item-row label=\"手机号\">\r\n          <n-input v-model:value=\"_tel\" type=\"tel\" placeholder=\"请输入手机号\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"密码\" :feedback='msg'>\r\n          <n-input v-model:value=\"_password\" type=\"password\" center clearable placeholder=\"请输入密码\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"确认密码\" v-if=\"register\">\r\n          <n-input v-model:value=\"confirmPassword\" type=\"password\" center clearable\r\n                   placeholder=\"再次输入密码\"/>\r\n        </n-form-item-row>\r\n\r\n        <div class=\"btn raw\" v-if=\"!register\">\r\n          <n-button @click=\"authPassword\" block type=\"primary\">登录</n-button>\r\n          <n-button @click=\"register=true\" block type=\"default\">注册</n-button>\r\n        </div>\r\n        <div class=\"btn raw\" v-if=\"register\">\r\n          <n-button @click=\"register=false\" block type=\"default\">登录</n-button>\r\n          <n-button @click=\"reg\" block type=\"primary\">注册</n-button>\r\n        </div>\r\n      </n-tab-pane>\r\n      <n-tab-pane name=\"code\" tab=\"验证码\">\r\n        <p class=\"title\">输入手机号自动登录/注册</p>\r\n\r\n        <n-form-item-row label=\"手机号\">\r\n          <n-input v-model:value=\"_tel\" type=\"tel\" placeholder=\"请输入手机号\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"短信验证码\" :feedback='msg'>\r\n          <n-input-group>\r\n            <n-input v-model:value=\"code\" center clearable placeholder=\"请输入短信验证码\"\r\n                     autocomplete=\"one-time-code\"\r\n            />\r\n            <n-button :disabled=\"_tel===''\" type=\"primary\" v-if=\"!device\" @click=\"getCode\">\r\n              发送验证码\r\n            </n-button>\r\n            <n-button :disabled=\"true\" type=\"primary\" v-if=\"device&&time>0\">\r\n              已发送({{ time }})\r\n            </n-button>\r\n            <n-button type=\"primary\" v-if=\"device&&time===0\" @click=\"getCode\">\r\n              再次发送\r\n            </n-button>\r\n          </n-input-group>\r\n\r\n        </n-form-item-row>\r\n        <div class=\"btn raw\">\r\n          <n-button type=\"primary\" block @click=\"auth\">登录/注册</n-button>\r\n        </div>\r\n      </n-tab-pane>\r\n    </n-tabs>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.yinAuth {\r\n\r\n}\r\n</style>\r\n","<script lang=\"ts\">\r\nimport {defineComponent} from 'vue'\r\nimport {yin} from 'yin-core-client'\r\nimport {NButton, NFormItemRow, NInput, NInputGroup, NTabPane, NTabs, useNotification} from \"naive-ui\";\r\n\r\nexport default defineComponent({\r\n  name: \"yinAuth\",\r\n  components: {NFormItemRow, NInputGroup, NButton, NTabs, NInput, NTabPane},\r\n  props: ['yinCore'],\r\n  data() {\r\n    return {\r\n      message: useNotification(),\r\n      _tel: '',\r\n      code: '',\r\n      _password: '',\r\n      confirmPassword: '',\r\n      device: '',\r\n      msg: '',\r\n      time: 60,\r\n      yin\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.yinCore) this.yin = this.yinCore\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"yinAuth\">\r\n    <h3>{{ yin.system.title }}</h3>\r\n    <template v-if=\"yin.system.uninitialized\">\r\n      <n-h4>初始化</n-h4>\r\n      <p>此时注册的用户将为管理员</p>\r\n    </template>\r\n    <n-tabs default-value=\"password\" size=\"large\">\r\n      <n-tab-pane name=\"password\" tab=\"密码\">\r\n        <n-form-item-row label=\"手机号\">\r\n          <n-input v-model:value=\"_tel\" type=\"tel\" placeholder=\"请输入手机号\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"密码\" :feedback='msg'>\r\n          <n-input v-model:value=\"_password\" type=\"password\" center clearable placeholder=\"请输入密码\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"确认密码\" v-if=\"register\">\r\n          <n-input v-model:value=\"confirmPassword\" type=\"password\" center clearable\r\n                   placeholder=\"再次输入密码\"/>\r\n        </n-form-item-row>\r\n\r\n        <div class=\"btn raw\" v-if=\"!register\">\r\n          <n-button @click=\"authPassword\" block type=\"primary\">登录</n-button>\r\n          <n-button @click=\"register=true\" block type=\"default\">注册</n-button>\r\n        </div>\r\n        <div class=\"btn raw\" v-if=\"register\">\r\n          <n-button @click=\"register=false\" block type=\"default\">登录</n-button>\r\n          <n-button @click=\"reg\" block type=\"primary\">注册</n-button>\r\n        </div>\r\n      </n-tab-pane>\r\n      <n-tab-pane name=\"code\" tab=\"验证码\">\r\n        <p class=\"title\">输入手机号自动登录/注册</p>\r\n\r\n        <n-form-item-row label=\"手机号\">\r\n          <n-input v-model:value=\"_tel\" type=\"tel\" placeholder=\"请输入手机号\"/>\r\n        </n-form-item-row>\r\n        <n-form-item-row label=\"短信验证码\" :feedback='msg'>\r\n          <n-input-group>\r\n            <n-input v-model:value=\"code\" center clearable placeholder=\"请输入短信验证码\"\r\n                     autocomplete=\"one-time-code\"\r\n            />\r\n            <n-button :disabled=\"_tel===''\" type=\"primary\" v-if=\"!device\" @click=\"getCode\">\r\n              发送验证码\r\n            </n-button>\r\n            <n-button :disabled=\"true\" type=\"primary\" v-if=\"device&&time>0\">\r\n              已发送({{ time }})\r\n            </n-button>\r\n            <n-button type=\"primary\" v-if=\"device&&time===0\" @click=\"getCode\">\r\n              再次发送\r\n            </n-button>\r\n          </n-input-group>\r\n\r\n        </n-form-item-row>\r\n        <div class=\"btn raw\">\r\n          <n-button type=\"primary\" block @click=\"auth\">登录/注册</n-button>\r\n        </div>\r\n      </n-tab-pane>\r\n    </n-tabs>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n.yinAuth {\r\n\r\n}\r\n</style>\r\n","<template>\n  <div class=\"nodeTree\" ref=\"table\" @scroll=\"screenCtrl\" @resize=\"screenCtrl\" @click=\"refresh\">\n    <div class=\"nodes\" ref=\"nodes\" @mousedown.left=\"lineStart\">\n      <YinObject v-if=\"root._id\" :object=\"root\" :style=\"{paddingRight:panel?'350px':''}\"/>\n    </div>\n    <header class=\"nodeFns\">\n      <n-button-group class=\"fns\">\n        <n-button @click=\"fullscreen\">\n          <n-icon size=\"21\">\n            <fullscreen-exit-filled v-if=\"isFullscreen\"/>\n            <fullscreen-filled v-else/>\n          </n-icon>\n        </n-button>\n\n        <template v-if=\"$yin.me._isRoot\">\n          <template v-if=\"yinCabMe._token\">\n            <n-button ghost :type=\"(panel==='ai')?'primary':'default'\" @click=\"panelCtrl('ai')\">AI</n-button>\n          </template>\n          <!--          <n-button v-else ghost :type=\"(panel==='yinCloud')?'primary':'default'\" @click=\"panelCtrl('yinCloud')\">引.云服务-->\n          <!--          </n-button>-->\n        </template>\n\n        <save-all/>\n        <n-button v-if=\"!object\">{{ $yin.me._title || '我' }}</n-button>\n      </n-button-group>\n    </header>\n\n    <div class=\"nodeInfo\">\n      screen\n      <pre>{{ screen }}</pre>\n      <pre>{{ keyList.dotLining }}</pre>\n      objectList\n      <pre>{{ objectList }}</pre>\n      keyList\n      <pre>{{ keyList }}</pre>\n      select\n      <pre>{{ selectStartPlace }}</pre>\n      <pre>{{ selectNowPlace }}</pre>\n    </div>\n\n    <yin-cloud-login class=\"panel\" v-if=\"panel==='yinCloud'\"/>\n    <yin-big-model class=\"panel\" v-if=\"panel==='ai'\"/>\n\n\n    <yin-menu-structure v-if=\"screen.menu?.type\" ref=\"menu\"\n                        :style=\"{left:screen.menu.x+'px',top:screen.menu.y+'px'}\"\n                        :screen=\"screen\" :objectList=\"objectList\"/>\n    <yin-menu-object v-else-if=\"screen.menu\" ref=\"menu\"\n                     :style=\"{left:screen.menu.x+'px',top:screen.menu.y+'px'}\"\n                     :screen=\"screen\" :objectList=\"objectList\"/>\n\n    <svg class=\"nodeLines\" :style=\"{minWidth: this.$refs.nodes?.scrollWidth,minHeight:this.$refs.nodes?.scrollHeight}\"\n         @mousedown.left=\"selectStart\"\n         @mousemove=\"screen.menu?lining($event):''\"\n         @click.right=\"clearDotLining\"\n    >\n      <rect v-if=\"selectNowPlace&&selectStartPlace\"\n            :x=\"Math.min(selectStartPlace.x,selectNowPlace.x)-1\"\n            :y=\"Math.min(selectStartPlace.y,selectNowPlace.y)-1\"\n            :width=\"Math.abs(selectStartPlace.x-selectNowPlace.x)\"\n            :height=\"Math.abs(selectStartPlace.y-selectNowPlace.y)\"\n            ry=\"2\" stroke=\"#333\" fill=\"#fafafa\" stroke-width=\"1\"/>\n      <g v-for=\"(line,title) in lines\" :ref=\"title\"\n         @mouseover=\"hoverLine(line,$event)\"\n         @mouseout=\"outLine(line,$event)\"\n         @mousedown.left.stop=\"lineToDrag(line)\">\n        <path class=\"line\" :id=\"title+'-shadow'\"\n              stroke=\"rgba(0,0,0,0)\" :stroke-width=\"8\" fill=\"none\" :d=\"line.path\"></path>\n        <path class=\"line\" :id=\"title\"\n              :stroke=\"line.hover?'#333':'#666'\" :stroke-width=\"line.hover?2:1\" fill=\"none\" :d=\"line.path\"></path>\n      </g>\n\n    </svg>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent, computed, nextTick} from 'vue';\nimport {yin, yinCab, Place, yinObject} from 'yin-core-client'\nimport {FullscreenFilled, FullscreenExitFilled, SaveAllOutlined} from '@vicons/material'\nimport YinMenuObject from \"@/components/node/menu/yinMenuObject.vue\";\nimport YinMenuStructure from \"@/components/node/menu/yinMenuStructure.vue\";\nimport SaveAll from \"@/components/editor/saveAll.vue\";\nimport YinBigModel from \"@/components/node/panel/yinBigModel.vue\";\nimport YinCloudLogin from \"@/components/node/panel/yinAuth.vue\";\n\nexport default defineComponent({\n  name: 'nodeTree',\n  props: ['object'],\n  components: {\n    YinCloudLogin,\n    YinBigModel,\n    SaveAll,\n    FullscreenFilled, FullscreenExitFilled, SaveAllOutlined,\n    YinMenuStructure, YinMenuObject\n  },\n  provide() {\n    return {\n      objectList: computed(() => this.objectList),\n      keyList: computed(() => this.keyList),\n      screen: computed(() => this.screen),\n      lines: computed(() => this.lines)\n    }\n  },\n  data() {\n    return {\n      root: {} as any,\n      objectList: {},\n      keyList: {},\n      screen: {\n        timer: new Date(),\n        target: [],\n        targetPlace: null,\n        events: {},\n        refs: [],\n        node: true\n      } as any,\n      lines: {},\n      lineStartPlace: null,\n      lineClearPlace: null,\n      selectStartPlace: null,\n      selectNowPlace: null,\n      timer: null,\n      space: false,\n      drag: {},\n      nodeTimer: '',\n      isFullscreen: false,\n      panel: '',\n      yinCabMe: {}\n      // lineHoverTimer: {}\n    }\n  },\n  // computed: {\n  //   selectZone() {\n  //     const s = this.lineStartPlace, n = this.selectNowPlace,\n  //         z = {\n  //           x: Math.min(s.x, n.x),\n  //           y: Math.min(s.x, n.x),\n  //           width:Math.abs()\n  //         }\n  //\n  //   }\n  // },\n  methods: {\n    async init() {\n      yin.on('ObjectEvents', (event, object, ...args) => {\n        if (args[0] instanceof Error) {\n\n        }\n        else {\n          const p = object instanceof yinObject ? object._place : object._place['module.id.key']\n          // console.log(event, p)\n          this.screen.events[p] = event\n          setTimeout(() => {\n            delete this.screen.events[p]\n          }, 100)\n        }\n      })\n\n\n      if (this.object)\n        this.root = this.object\n      else\n        this.root = this.$yin.me\n      this.screenCtrl()\n      // this.putCtx()\n      await this.makeNode()\n      // this.nodeTimer = setInterval(() => {\n      //   this.screenCtrl()\n      //   this.screen.timer = Date.now()\n      // }, 2000)\n      this.initCab()\n    },\n    async initCab() {\n      try {\n        await yinCab.start()\n        this.yinCabMe = yinCab.me\n      }\n      catch (e) {\n\n      }\n    },\n    refresh(e) {\n      if (this.screen.menu)\n        this.lineEnd(e)\n      setTimeout(() => {\n        this.screen.timer = Date.now()\n      }, 16)\n    },\n    async makeNode() {\n      // console.log('makeNode', this.screen.timer)\n      // console.time('makeNode')\n      this.lines = {}\n      // for (let t in this.keyList) {\n      //     const title = new this.Place(t)\n      //     this.pushLine(t, this.objectList[title.parent], this.keyList[t])\n      // }\n      for (let t in this.objectList) {\n        const key = this.objectList[t]\n        for (let pTitle in key.parents) {\n          if (key.parents[pTitle])\n            this.pushLine(t, pTitle, this.keyList[pTitle], key)\n        }\n      }\n      await nextTick()\n      this.screen.timer = Date.now()\n    },\n\n    pushLine(title, pTitle, parent, key) {\n      if (title && parent && key) {\n        // const kl = key.l, ky = key.y, pr = parent.r, py = parent.y, mx = this.m(kl, pr)\n        // this.lines[title] = 'M ' + kl + ',' + ky + ' C ' + mx + ',' + ky + ' ' + mx + ',' + py + ' ' + pr + ',' + py\n        const tx = key.left, ty = key.dotY, ox = parent.right, oy = parent.dotY\n        const mx = (ox + tx) / 2,\n            my = (oy + ty) / 2,\n            height = Math.abs(ty - oy),\n            width = Math.abs(tx - ox),\n            m = 13, //初始连线长度,\n            br = 13,//转弯半径\n            r = height > br * 2 ? br : height / 2,\n            yr = oy > ty ? r : -r;\n\n        const ctx = new this.Ctx(title, pTitle)\n        ctx.moveTo(ox, oy)\n\n        // if (height > br * 2) {\n        //   if (tx <= ox + m) {\n        //     ctx.lineTo(ox + m - r, oy)\n        //     ctx.bezierCurveTo(ox + m, oy, ox + m, oy, ox + m, oy - yr)\n        //     ctx.lineTo(ox + m, my + yr)\n        //     ctx.bezierCurveTo(ox + m, my, ox + m, my, ox + m - r, my)\n        //     ctx.lineTo(tx - m + r, my)\n        //     ctx.bezierCurveTo(tx - m, my, tx - m, my, tx - m, my - yr)\n        //     ctx.lineTo(tx - m, ty + yr)\n        //     ctx.bezierCurveTo(tx - m, ty, tx - m, ty, tx - m + r, ty)\n        //   } else {\n        //     ctx.lineTo(mx - r, oy)\n        //     ctx.bezierCurveTo(mx, oy, mx, oy, mx, oy - yr)\n        //     ctx.lineTo(mx, ty + yr)\n        //     ctx.bezierCurveTo(mx, ty, mx, ty, mx + r, ty)\n        //   }\n        //   ctx.lineTo(tx, ty)\n        // } else if (width > m * 2) {\n        //   ctx.lineTo(ox + m, oy)\n        //   ctx.bezierCurveTo(mx, oy, mx, ty, tx - m, ty)\n        //   ctx.lineTo(tx, ty)\n        // } else {\n        //   ctx.bezierCurveTo(mx, oy, mx, ty, tx, ty)\n        // }\n\n        if (height > br * 2) {\n          if (tx <= ox + m) {\n            ctx.lineTo(ox + m - r, oy)\n            ctx.bezierCurveTo(ox + m, oy, ox + m, oy, ox + m, oy - yr)\n            ctx.lineTo(ox + m, my + yr)\n            ctx.bezierCurveTo(ox + m, my, ox + m, my, ox + m - r, my)\n            ctx.lineTo(tx - m + r, my)\n            ctx.bezierCurveTo(tx - m, my, tx - m, my, tx - m, my - yr)\n            ctx.lineTo(tx - m, ty + yr)\n            ctx.bezierCurveTo(tx - m, ty, tx - m, ty, tx - m + r, ty)\n          }\n          else {\n            ctx.lineTo(mx - r, oy)\n            ctx.bezierCurveTo(mx, oy, mx, oy, mx, oy - yr)\n            ctx.lineTo(mx, ty + yr)\n            ctx.bezierCurveTo(mx, ty, mx, ty, mx + r, ty)\n          }\n          ctx.lineTo(tx, ty)\n        }\n        else if (width > m * 2) {\n          ctx.lineTo(ox + m, oy)\n          ctx.bezierCurveTo(mx, oy, mx, ty, tx - m, ty)\n          ctx.lineTo(tx, ty)\n        }\n        else {\n          ctx.bezierCurveTo(mx, oy, mx, ty, tx, ty)\n        }\n\n\n        this.lines[ctx.title] = ctx\n      }\n    },\n    Ctx: class Ctx {\n      path = ''\n      hover = false\n      title = ''\n      parent = ''\n      to = ''\n\n      constructor(title, pTitle) {\n        this.title = title + '-' + pTitle\n        this.parent = pTitle\n        this.to = title\n      }\n\n      moveTo(x, y) {\n        this.path += 'M ' + x + ',' + y + ' '\n      }\n\n      lineTo(x, y) {\n        this.path += \"L \" + x + ',' + y + ' '\n      }\n\n      bezierCurveTo(a1, a2, b1, b2, c1, c2) {\n        this.path += \"C \" + a1 + ',' + a2 + ' ' + b1 + ',' + b2 + ' ' + c1 + ',' + c2 + ' '\n      }\n    },\n\n    /**\n     * 连线！！！\n     * 引的核心\n     * @param e\n     */\n    lineStart(e) {\n      if (e.target.title && !/^_NodeSkip\\./.test(e.target.title)) {\n        const p = new Place(e.target.title)\n        if (p.id) {\n          e.preventDefault()\n          if (p.key) {\n            // 节点\n          }\n          else {\n            // 对象\n            this.lineStartPlace = p\n            if (this.screen.target?.indexOf(e.target.title) !== -1) {\n              for (let id of this.screen.target) {\n                this.objectList[id].parents.dotLining = true\n              }\n            }\n            else {\n              this.screen.target = []\n              this.objectList[p].parents.dotLining = true\n            }\n          }\n        }\n      }\n    },\n    lineToDrag(line) {\n      const target = []\n      this.lineStartPlace = line.to\n      this.lineClearPlace = line.parent\n      if (this.screen.target?.indexOf(line.to) !== -1) {\n        for (let id of this.screen.target) {\n          const objectBox = this.objectList[id]\n          if (objectBox.parents[line.parent]) {\n            target.push(id)\n            this.objectList[id].parents.dotLining = true\n            this.objectList[id].parents[line.parent] = false\n          }\n        }\n      }\n      else {\n        this.objectList[line.to].parents.dotLining = true\n        this.objectList[line.to].parents[line.parent] = false\n      }\n      this.screen.target = target\n    },\n    async lineEnd(e) {\n      if (e.which === 1) {\n        const p = this.lineStartPlace,\n            c = this.lineClearPlace,\n            targetList = this.screen.target,\n            dotLining = this.keyList.dotLining\n        this.clearDotLining()\n        if (p) {\n          if (e.target.title === c || !dotLining) {\n            if (targetList.length)\n              for (let id of targetList) {\n                this.objectList[id].parents[c] = true\n              }\n            else\n              this.objectList[p].parents[c] = true\n          }\n          else {\n            if (c) {\n              const clearKey = new Place(c),\n                  target = await yin.get(clearKey),\n                  key = target._schemaMix[clearKey.key]\n              if (key.type === 'Array') {\n                if (targetList.length)\n                  for (let id of targetList) {\n                    await target[clearKey.key].remove(new Place(id))\n                  }\n                else\n                  await target[clearKey.key].remove(p)\n              }\n              //  else if (yin.structureType.indexOf(key.type) !== -1) {\n              else {\n                delete target[clearKey.key]\n                await target._save()\n              }\n            }\n            if (p && e.target.title) {\n              const k = new Place(e.target.title)\n              const target = await yin.get(k),\n                  key = target._schemaMix[k.key]\n              if (key.type === 'Array') {\n                if (targetList.length)\n                  for (let id of targetList) {\n                    await target[k.key].push(id)\n                  }\n                else\n                  await target[k.key].push(p)\n              }\n              else {\n                target[k.key] = p\n                await target._save()\n              }\n              if (this.objectList[p])\n                this.objectList[p].parents[e.target.title] = true\n            }\n          }\n        }\n      }\n    },\n    inClass(dom, c) {\n      console.log({dom}, dom.classList)\n      if (dom !== document.body) {\n        if (dom.classList.includes(c))\n          return true\n        return this.inClass(dom.parentElement, c)\n      }\n      return false\n    },\n    clearDotLining() {\n      const p = this.lineStartPlace\n      this.lineStartPlace = false\n      this.lineClearPlace = false\n      if (p && this.objectList[p]?.parents)\n        if (this.screen.target.length)\n          for (let id of this.screen.target)\n            delete this.objectList[id].parents.dotLining\n        else\n          delete this.objectList[p].parents.dotLining\n\n      delete this.keyList.dotLining\n      // console.log(this.selectNowPlace)\n      if (this.selectStartPlace && this.selectNowPlace === null) {\n        /**\n         * 空白点击\n         */\n        this.screen.target = []\n        this.screen.targetPlace = null\n      }\n      this.selectStartPlace = null\n      this.selectNowPlace = null\n      delete this.screen.menu\n\n    },\n    lining(e) {\n      // console.log(e)\n      if (this.lineStartPlace) {\n        e.preventDefault()\n        delete this.screen.menu\n\n        /**\n         * 连线\n         */\n        this.keyList.dotLining = {\n          left: e.x + this.screen.left,\n          right: e.x + this.screen.left,\n          dotY: e.y + this.screen.top\n        }\n      }\n      else if (this.selectStartPlace) {\n        /**\n         * 选择\n         */\n        e.preventDefault()\n        delete this.screen.menu\n        this.screen.target = []\n        this.selectNowPlace = {x: e.x + this.screen.left, y: e.y + this.screen.top}\n\n        const sb = {\n          top: Math.min(this.selectStartPlace.y, this.selectNowPlace.y),\n          left: Math.min(this.selectStartPlace.x, this.selectNowPlace.x),\n          bottom: Math.max(this.selectStartPlace.y, this.selectNowPlace.y),\n          right: Math.max(this.selectStartPlace.x, this.selectNowPlace.x)\n        }\n\n        // console.time('selectLining')\n\n        for (let place in this.objectList) {\n          if (!/^_NodeSkip\\./.test(place)) {\n            const b = this.objectList[place],\n                bb = {\n                  top: sb.top - b.height,\n                  bottom: sb.bottom + b.height,\n                  left: sb.left - b.width,\n                  right: sb.right + b.width\n                }\n\n            if (b.top > bb.top && b.bottom < bb.bottom && b.left > bb.left && b.right < bb.right)\n              this.screen.target.push(place)\n          }\n        }\n        // console.timeEnd('selectLining')\n      }\n    },\n    // backgroundClick() {\n    //   console.log('>>>>>>>>')\n    //   this.screen.target = []\n    // },\n    hoverLine(d, e) {\n      if (d.parent !== 'dotLining' && !this.selectStartPlace) {\n        if (this.screen.target?.indexOf(d.to) !== -1) {\n          for (let id of this.screen.target) {\n            for (let i in this.lines) {\n              const line = this.lines[i]\n              if (line.to === id && line.parent === d.parent)\n                line.hover = true\n            }\n          }\n        }\n        else {\n          d.hover = true\n        }\n      }\n    },\n    outLine(d, e) {\n      for (let i in this.lines) {\n        const line = this.lines[i]\n        line.hover = false\n      }\n    },\n    selectStart(e) {\n      if (!this.lineStartPlace) {\n        this.selectStartPlace = {x: e.x + this.screen.left, y: e.y + this.screen.top}\n      }\n    },\n\n    /**\n     * 屏幕拖拽\n     * 此功能已废弃，点击卡片时自动滚动显然更好用\n     * 拦截按键还可能引发意外\n     * @param e\n     */\n    // dragStart(e) {\n    //   if (this.space)\n    //     this.drag = {\n    //       x: e.screenX,\n    //       y: e.screenY,\n    //       tableX: this.screen.left,\n    //       tableY: this.screen.top\n    //     }\n    // },\n    // dragging(e) {\n    //   e.preventDefault();\n    //   if (this.drag.x) {\n    //     this.$refs.table.scrollLeft = this.drag.tableX - (e.screenX - this.drag.x)\n    //     this.$refs.table.scrollTop = this.drag.tableY - (e.screenY - this.drag.y)\n    //   }\n    // },\n    // dragEnd(e) {\n    //   this.drag = {}\n    // },\n    // keydown(ev) {\n    //   if (ev.code === 'Space') {\n    //     if (ev.target.nodeName == 'BODY') {\n    //       ev.preventDefault()\n    //       this.space = true\n    //     }\n    //   }\n    // },\n    // keyup(ev) {\n    //   if (ev.code === 'Space') {\n    //     this.space = false\n    //   }\n    // },\n    /**\n     * 显示区域刷新\n     */\n    screenCtrl() {\n      const table = this.$refs.table\n      this.screen.left = table.scrollLeft\n      this.screen.top = table.scrollTop\n      this.screen.width = table.scrollWidth\n      this.screen.height = table.scrollHeight\n      // Object.assign(this.screen, {\n      //   /**\n      //    * 移动端body向上滑动时标题栏会变小，菜单栏会隐藏\n      //    * 本想按这个进行适配，但是移动端body上的fixed会失效\n      //    * window上的scroll事件并不总能激活，非常蛋疼\n      //    * 现在只能搞个框，在框里面滚动\n      //    * 加了个全屏，先凑合用吧\n      //    */\n      //   // left: window.scrollX,\n      //   // top: window.scrollY,\n      //   // width: window.visualViewport.width,\n      //   // height: window.visualViewport.height,\n      //   left: table.scrollLeft,\n      //   top: table.scrollTop,\n      //   width: table.scrollWidth,\n      //   height: table.scrollHeight,\n      //   timer: this.screen.timer,\n      //   target: this.screen.target || [],\n      //   events: this.screen.events || {},\n      //   targetPlace: this.screen.targetPlace\n      // })\n    },\n    fullscreen() {\n      if (this.isFullscreen)\n        document.exitFullscreen()\n      else\n        this.$refs.table.requestFullscreen()\n      this.isFullscreen = !this.isFullscreen\n    },\n    makeTarget(v, _v) {\n      setTimeout(() => {\n        if (v && v.length === 1 && v[0] !== _v[0]) {\n          const dot = document.getElementById(this.screen.target[0])?.getBoundingClientRect()\n          if (dot) {\n            const s = this.screen, sw = this.$refs.table.clientWidth, sh = this.$refs.table.clientHeight,\n                option = {behavior: 'smooth'} as any,\n                padding = sw > 1024 ? 55 : 6,\n                toTop = dot.top + s.top - padding,\n                toBottom = dot.bottom + s.top - sh + padding,\n                toLeft = dot.left + s.left - padding,\n                toRight = dot.right - sw + s.left + padding\n            // console.log('y', dot.top, sh)\n            // console.log('r', dot.right, sw)\n\n\n            // if (dot.height < (sh - padding * 2)) {\n            /**\n             * 上下滚动\n             */\n            if (dot.height < sh) {\n              if (dot.top < 0)\n                option.top = toTop\n              else if (dot.bottom > sh)\n                option.top = toBottom\n            }\n            else {\n              if (dot.bottom < 0)\n                option.top = toTop\n              else if (dot.top < 0 && dot.bottom < sh)\n                option.top = toBottom\n              else if (dot.top < 0 && dot.bottom > sh) {\n                // console.log('middle')\n              }\n              else if (dot.top > 0)\n                option.top = toTop\n            }\n\n            /**\n             * 左右滚动\n             */\n            if (dot.width < sw) {\n              if (dot.left < 0)\n                option.left = toLeft\n              else if (dot.right > sw)\n                option.left = toRight\n            }\n            else {\n              if (dot.right < 0)\n                option.left = toLeft\n              else if (dot.left < 0 && dot.right < sw)\n                option.left = toRight\n              else if (dot.left < 0 && dot.right > sw) {\n                // console.log('middle')\n              }\n              else if (dot.left > 0)\n                option.left = toLeft\n            }\n            // if (dot.left < 0)\n            //   option.left = dot.left + s.left - padding\n            // if (dot.right > sw) {\n            //   if (dot.width < sw)\n            //     option.left = dot.right - sw + s.left + padding\n            //   else\n            //     option.left = dot.left + s.left - padding\n            // }\n            // console.log(option)\n            if (option.left || option.top) {\n              this.$refs.table.scroll(option)\n              // this.screen.timer = Date.now()\n            }\n          }\n        }\n      }, 100)\n    },\n    async menuChange(menu, _menu) {\n      if (menu) {\n        this.removeEvents()\n        const place = new Place(menu.target), _place = _menu && new Place(_menu.target)\n        if (place.key) this.screen.target = [place['module.id'].valueOf(), menu.target]\n        else if (_place && _place.key || !this.screen.target.includes(menu.target)) this.screen.target = [menu.target]\n\n        await nextTick()\n        setTimeout(() => {\n          const menuBox = this.$refs.menu.$el,\n              mr = menu.x + menuBox.clientWidth,\n              mb = menu.y + menuBox.clientHeight,\n              s = this.screen,\n              sw = this.$refs.table.clientWidth,\n              sh = this.$refs.table.clientHeight,\n              option = {behavior: 'smooth'} as any\n\n          if (mr > s.left + sw) {\n            option.left = mr - sw + 13\n          }\n\n          if (mb > s.top + sh) {\n            option.top = mb - sh + 13\n          }\n\n\n          if (option.left || option.top) {\n            this.$refs.table.scroll(option)\n          }\n        }, 100)\n\n\n      }\n      else\n        this.listenEvents()\n    },\n    async refChange(ref) {\n      if (ref) {\n        for (let id of ref) {\n          this.screen.events[id] = 'ref'\n        }\n        // if (ref.length)\n        //   await navigator.clipboard.writeText(ref)\n      }\n    },\n    listenEvents() {\n      document.addEventListener('mouseup', this.lineEnd)\n      document.addEventListener('mousemove', this.lining)\n    },\n    removeEvents() {\n      document.removeEventListener('mouseup', this.lineEnd)\n      document.removeEventListener('mousemove', this.lining)\n      // window.removeEventListener('scroll', this.screenCtrl)\n      // window.removeEventListener('keydown', this.keydown)\n      // window.removeEventListener('keyup', this.keyup)\n    },\n    copy(e) {\n      const selected = document.getSelection().type !== 'Caret';\n      if (!selected && this.screen.target.length) {\n        this.screen.refs = this.screen.target\n        e.clipboardData.setData('text', this.screen.target)\n        e.preventDefault()\n      }\n      if (selected)\n        this.screen.refs = []\n    },\n    async cut(e) {\n      const selected = document.getSelection().type !== 'Caret';\n      if (!selected && this.screen.target.length) {\n        this.screen.refs = this.screen.target\n        e.clipboardData.setData('text', this.screen.target)\n\n        for (let id of this.screen.target) {\n          const node = this.objectList[id]\n          if (node && node.parent) {\n            await nextTick()\n            const parent = await yin.get(node.parent)\n            await parent[node.parent.key].remove(id)\n          }\n        }\n        e.preventDefault()\n      }\n      if (selected)\n        this.screen.refs = []\n    },\n    async paste(e) {\n      if (this.screen.targetPlace) {\n        e.preventDefault()\n        const p = new Place(this.screen.targetPlace),\n            parent = await yin.get(p),\n            key = parent._schemaMix[p.key],\n            paste = e.clipboardData.getData(\"text\"),\n            els = [];\n        let refs = paste.split(','),\n            _refs = this.screen.refs;\n\n        if (key.type !== 'Array') {\n          if (refs.length)\n            refs.length = 1\n          if (_refs.length)\n            _refs = [this.screen.refs[0]]\n        }\n        for (let id of refs) {\n          try {\n            const object = await yin.get(id)\n            els.push(object)\n          }\n          catch (e) {\n          }\n        }\n        if (!els.length && _refs) {\n          for (let id of _refs) {\n            try {\n              const object = await yin.get(id)\n              els.push(object)\n            }\n            catch (e) {\n            }\n          }\n        }\n        if (els.length) {\n          if (key.type === 'Array') {\n            for (let object of els) {\n              await parent[p.key].push(object)\n            }\n          }\n          else {\n            parent[p.key] = els[0]\n            await parent._save()\n          }\n        }\n      }\n    },\n    panelCtrl(panel: string) {\n      this.panel === panel ? this.panel = '' : this.panel = panel\n    }\n  },\n  mounted() {\n    this.init()\n    this.listenEvents()\n    document.addEventListener('copy', this.copy)\n    document.addEventListener('cut', this.cut)\n    document.addEventListener('paste', this.paste)\n  },\n  watch: {\n    objectList: {\n      handler: 'makeNode',\n      deep: true\n    },\n    keyList: {\n      handler: 'makeNode',\n      deep: true\n    },\n    'screen.target': 'makeTarget',\n    'screen.menu': 'menuChange',\n    'screen.refs': 'refChange'\n  },\n  beforeUnmount() {\n    clearInterval(this.nodeTimer)\n    this.removeEvents()\n    document.removeEventListener('copy', this.copy)\n    document.removeEventListener('cut', this.cut)\n    document.removeEventListener('paste', this.paste)\n    yin.removeEvent('ObjectEvents')\n  }\n})\n</script>\n\n<style scoped lang=\"less\">\n.nodeTree {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: scroll;\n  background-color: var(--color-background);\n\n  &::-webkit-scrollbar {\n    display: none\n  }\n\n  .nodes {\n    padding: 21px 21px 55px 21px;\n    display: flex;\n  }\n\n  .nodeLines {\n    position: absolute;\n    z-index: 0;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n\n    transition: all 1s;\n\n    .line {\n      transition: stroke-width 200ms;\n    }\n  }\n\n\n  .nodeFns {\n    position: fixed;\n    top: 21px;\n    right: 21px;\n    z-index: 1000;\n    background-color: var(--color-background);\n    //padding: 0;\n    //box-sizing: border-box;\n    //border-radius: var(--border-radius);\n    //overflow: hidden;\n    //display: flex;\n    //justify-content: space-between;\n\n    .fns {\n      box-shadow: 0 0 13px var(--color-shadow);\n    }\n\n  }\n\n  .nodeInfo {\n    position: fixed;\n    z-index: 0;\n    top: 0;\n    right: 0;\n    user-select: none;\n    opacity: 0.4;\n  }\n\n  .panel {\n    position: fixed;\n    z-index: 1000;\n    background-color: white;\n    border: var(--border);\n    border-radius: var(--border-radius);\n    right: 21px;\n    top: 68px;\n    bottom: 21px;\n    max-width: 38vw;\n    min-width: 350px;\n  }\n}\n\n\n</style>\n","<template>\n  <div class=\"nodeTree\" ref=\"table\" @scroll=\"screenCtrl\" @resize=\"screenCtrl\" @click=\"refresh\">\n    <div class=\"nodes\" ref=\"nodes\" @mousedown.left=\"lineStart\">\n      <YinObject v-if=\"root._id\" :object=\"root\" :style=\"{paddingRight:panel?'350px':''}\"/>\n    </div>\n    <header class=\"nodeFns\">\n      <n-button-group class=\"fns\">\n        <n-button @click=\"fullscreen\">\n          <n-icon size=\"21\">\n            <fullscreen-exit-filled v-if=\"isFullscreen\"/>\n            <fullscreen-filled v-else/>\n          </n-icon>\n        </n-button>\n\n        <template v-if=\"$yin.me._isRoot\">\n          <template v-if=\"yinCabMe._token\">\n            <n-button ghost :type=\"(panel==='ai')?'primary':'default'\" @click=\"panelCtrl('ai')\">AI</n-button>\n          </template>\n          <!--          <n-button v-else ghost :type=\"(panel==='yinCloud')?'primary':'default'\" @click=\"panelCtrl('yinCloud')\">引.云服务-->\n          <!--          </n-button>-->\n        </template>\n\n        <save-all/>\n        <n-button v-if=\"!object\">{{ $yin.me._title || '我' }}</n-button>\n      </n-button-group>\n    </header>\n\n    <div class=\"nodeInfo\">\n      screen\n      <pre>{{ screen }}</pre>\n      <pre>{{ keyList.dotLining }}</pre>\n      objectList\n      <pre>{{ objectList }}</pre>\n      keyList\n      <pre>{{ keyList }}</pre>\n      select\n      <pre>{{ selectStartPlace }}</pre>\n      <pre>{{ selectNowPlace }}</pre>\n    </div>\n\n    <yin-cloud-login class=\"panel\" v-if=\"panel==='yinCloud'\"/>\n    <yin-big-model class=\"panel\" v-if=\"panel==='ai'\"/>\n\n\n    <yin-menu-structure v-if=\"screen.menu?.type\" ref=\"menu\"\n                        :style=\"{left:screen.menu.x+'px',top:screen.menu.y+'px'}\"\n                        :screen=\"screen\" :objectList=\"objectList\"/>\n    <yin-menu-object v-else-if=\"screen.menu\" ref=\"menu\"\n                     :style=\"{left:screen.menu.x+'px',top:screen.menu.y+'px'}\"\n                     :screen=\"screen\" :objectList=\"objectList\"/>\n\n    <svg class=\"nodeLines\" :style=\"{minWidth: this.$refs.nodes?.scrollWidth,minHeight:this.$refs.nodes?.scrollHeight}\"\n         @mousedown.left=\"selectStart\"\n         @mousemove=\"screen.menu?lining($event):''\"\n         @click.right=\"clearDotLining\"\n    >\n      <rect v-if=\"selectNowPlace&&selectStartPlace\"\n            :x=\"Math.min(selectStartPlace.x,selectNowPlace.x)-1\"\n            :y=\"Math.min(selectStartPlace.y,selectNowPlace.y)-1\"\n            :width=\"Math.abs(selectStartPlace.x-selectNowPlace.x)\"\n            :height=\"Math.abs(selectStartPlace.y-selectNowPlace.y)\"\n            ry=\"2\" stroke=\"#333\" fill=\"#fafafa\" stroke-width=\"1\"/>\n      <g v-for=\"(line,title) in lines\" :ref=\"title\"\n         @mouseover=\"hoverLine(line,$event)\"\n         @mouseout=\"outLine(line,$event)\"\n         @mousedown.left.stop=\"lineToDrag(line)\">\n        <path class=\"line\" :id=\"title+'-shadow'\"\n              stroke=\"rgba(0,0,0,0)\" :stroke-width=\"8\" fill=\"none\" :d=\"line.path\"></path>\n        <path class=\"line\" :id=\"title\"\n              :stroke=\"line.hover?'#333':'#666'\" :stroke-width=\"line.hover?2:1\" fill=\"none\" :d=\"line.path\"></path>\n      </g>\n\n    </svg>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent, computed, nextTick} from 'vue';\nimport {yin, yinCab, Place, yinObject} from 'yin-core-client'\nimport {FullscreenFilled, FullscreenExitFilled, SaveAllOutlined} from '@vicons/material'\nimport YinMenuObject from \"@/components/node/menu/yinMenuObject.vue\";\nimport YinMenuStructure from \"@/components/node/menu/yinMenuStructure.vue\";\nimport SaveAll from \"@/components/editor/saveAll.vue\";\nimport YinBigModel from \"@/components/node/panel/yinBigModel.vue\";\nimport YinCloudLogin from \"@/components/node/panel/yinAuth.vue\";\n\nexport default defineComponent({\n  name: 'nodeTree',\n  props: ['object'],\n  components: {\n    YinCloudLogin,\n    YinBigModel,\n    SaveAll,\n    FullscreenFilled, FullscreenExitFilled, SaveAllOutlined,\n    YinMenuStructure, YinMenuObject\n  },\n  provide() {\n    return {\n      objectList: computed(() => this.objectList),\n      keyList: computed(() => this.keyList),\n      screen: computed(() => this.screen),\n      lines: computed(() => this.lines)\n    }\n  },\n  data() {\n    return {\n      root: {} as any,\n      objectList: {},\n      keyList: {},\n      screen: {\n        timer: new Date(),\n        target: [],\n        targetPlace: null,\n        events: {},\n        refs: [],\n        node: true\n      } as any,\n      lines: {},\n      lineStartPlace: null,\n      lineClearPlace: null,\n      selectStartPlace: null,\n      selectNowPlace: null,\n      timer: null,\n      space: false,\n      drag: {},\n      nodeTimer: '',\n      isFullscreen: false,\n      panel: '',\n      yinCabMe: {}\n      // lineHoverTimer: {}\n    }\n  },\n  // computed: {\n  //   selectZone() {\n  //     const s = this.lineStartPlace, n = this.selectNowPlace,\n  //         z = {\n  //           x: Math.min(s.x, n.x),\n  //           y: Math.min(s.x, n.x),\n  //           width:Math.abs()\n  //         }\n  //\n  //   }\n  // },\n  methods: {\n    async init() {\n      yin.on('ObjectEvents', (event, object, ...args) => {\n        if (args[0] instanceof Error) {\n\n        }\n        else {\n          const p = object instanceof yinObject ? object._place : object._place['module.id.key']\n          // console.log(event, p)\n          this.screen.events[p] = event\n          setTimeout(() => {\n            delete this.screen.events[p]\n          }, 100)\n        }\n      })\n\n\n      if (this.object)\n        this.root = this.object\n      else\n        this.root = this.$yin.me\n      this.screenCtrl()\n      // this.putCtx()\n      await this.makeNode()\n      // this.nodeTimer = setInterval(() => {\n      //   this.screenCtrl()\n      //   this.screen.timer = Date.now()\n      // }, 2000)\n      this.initCab()\n    },\n    async initCab() {\n      try {\n        await yinCab.start()\n        this.yinCabMe = yinCab.me\n      }\n      catch (e) {\n\n      }\n    },\n    refresh(e) {\n      if (this.screen.menu)\n        this.lineEnd(e)\n      setTimeout(() => {\n        this.screen.timer = Date.now()\n      }, 16)\n    },\n    async makeNode() {\n      // console.log('makeNode', this.screen.timer)\n      // console.time('makeNode')\n      this.lines = {}\n      // for (let t in this.keyList) {\n      //     const title = new this.Place(t)\n      //     this.pushLine(t, this.objectList[title.parent], this.keyList[t])\n      // }\n      for (let t in this.objectList) {\n        const key = this.objectList[t]\n        for (let pTitle in key.parents) {\n          if (key.parents[pTitle])\n            this.pushLine(t, pTitle, this.keyList[pTitle], key)\n        }\n      }\n      await nextTick()\n      this.screen.timer = Date.now()\n    },\n\n    pushLine(title, pTitle, parent, key) {\n      if (title && parent && key) {\n        // const kl = key.l, ky = key.y, pr = parent.r, py = parent.y, mx = this.m(kl, pr)\n        // this.lines[title] = 'M ' + kl + ',' + ky + ' C ' + mx + ',' + ky + ' ' + mx + ',' + py + ' ' + pr + ',' + py\n        const tx = key.left, ty = key.dotY, ox = parent.right, oy = parent.dotY\n        const mx = (ox + tx) / 2,\n            my = (oy + ty) / 2,\n            height = Math.abs(ty - oy),\n            width = Math.abs(tx - ox),\n            m = 13, //初始连线长度,\n            br = 13,//转弯半径\n            r = height > br * 2 ? br : height / 2,\n            yr = oy > ty ? r : -r;\n\n        const ctx = new this.Ctx(title, pTitle)\n        ctx.moveTo(ox, oy)\n\n        // if (height > br * 2) {\n        //   if (tx <= ox + m) {\n        //     ctx.lineTo(ox + m - r, oy)\n        //     ctx.bezierCurveTo(ox + m, oy, ox + m, oy, ox + m, oy - yr)\n        //     ctx.lineTo(ox + m, my + yr)\n        //     ctx.bezierCurveTo(ox + m, my, ox + m, my, ox + m - r, my)\n        //     ctx.lineTo(tx - m + r, my)\n        //     ctx.bezierCurveTo(tx - m, my, tx - m, my, tx - m, my - yr)\n        //     ctx.lineTo(tx - m, ty + yr)\n        //     ctx.bezierCurveTo(tx - m, ty, tx - m, ty, tx - m + r, ty)\n        //   } else {\n        //     ctx.lineTo(mx - r, oy)\n        //     ctx.bezierCurveTo(mx, oy, mx, oy, mx, oy - yr)\n        //     ctx.lineTo(mx, ty + yr)\n        //     ctx.bezierCurveTo(mx, ty, mx, ty, mx + r, ty)\n        //   }\n        //   ctx.lineTo(tx, ty)\n        // } else if (width > m * 2) {\n        //   ctx.lineTo(ox + m, oy)\n        //   ctx.bezierCurveTo(mx, oy, mx, ty, tx - m, ty)\n        //   ctx.lineTo(tx, ty)\n        // } else {\n        //   ctx.bezierCurveTo(mx, oy, mx, ty, tx, ty)\n        // }\n\n        if (height > br * 2) {\n          if (tx <= ox + m) {\n            ctx.lineTo(ox + m - r, oy)\n            ctx.bezierCurveTo(ox + m, oy, ox + m, oy, ox + m, oy - yr)\n            ctx.lineTo(ox + m, my + yr)\n            ctx.bezierCurveTo(ox + m, my, ox + m, my, ox + m - r, my)\n            ctx.lineTo(tx - m + r, my)\n            ctx.bezierCurveTo(tx - m, my, tx - m, my, tx - m, my - yr)\n            ctx.lineTo(tx - m, ty + yr)\n            ctx.bezierCurveTo(tx - m, ty, tx - m, ty, tx - m + r, ty)\n          }\n          else {\n            ctx.lineTo(mx - r, oy)\n            ctx.bezierCurveTo(mx, oy, mx, oy, mx, oy - yr)\n            ctx.lineTo(mx, ty + yr)\n            ctx.bezierCurveTo(mx, ty, mx, ty, mx + r, ty)\n          }\n          ctx.lineTo(tx, ty)\n        }\n        else if (width > m * 2) {\n          ctx.lineTo(ox + m, oy)\n          ctx.bezierCurveTo(mx, oy, mx, ty, tx - m, ty)\n          ctx.lineTo(tx, ty)\n        }\n        else {\n          ctx.bezierCurveTo(mx, oy, mx, ty, tx, ty)\n        }\n\n\n        this.lines[ctx.title] = ctx\n      }\n    },\n    Ctx: class Ctx {\n      path = ''\n      hover = false\n      title = ''\n      parent = ''\n      to = ''\n\n      constructor(title, pTitle) {\n        this.title = title + '-' + pTitle\n        this.parent = pTitle\n        this.to = title\n      }\n\n      moveTo(x, y) {\n        this.path += 'M ' + x + ',' + y + ' '\n      }\n\n      lineTo(x, y) {\n        this.path += \"L \" + x + ',' + y + ' '\n      }\n\n      bezierCurveTo(a1, a2, b1, b2, c1, c2) {\n        this.path += \"C \" + a1 + ',' + a2 + ' ' + b1 + ',' + b2 + ' ' + c1 + ',' + c2 + ' '\n      }\n    },\n\n    /**\n     * 连线！！！\n     * 引的核心\n     * @param e\n     */\n    lineStart(e) {\n      if (e.target.title && !/^_NodeSkip\\./.test(e.target.title)) {\n        const p = new Place(e.target.title)\n        if (p.id) {\n          e.preventDefault()\n          if (p.key) {\n            // 节点\n          }\n          else {\n            // 对象\n            this.lineStartPlace = p\n            if (this.screen.target?.indexOf(e.target.title) !== -1) {\n              for (let id of this.screen.target) {\n                this.objectList[id].parents.dotLining = true\n              }\n            }\n            else {\n              this.screen.target = []\n              this.objectList[p].parents.dotLining = true\n            }\n          }\n        }\n      }\n    },\n    lineToDrag(line) {\n      const target = []\n      this.lineStartPlace = line.to\n      this.lineClearPlace = line.parent\n      if (this.screen.target?.indexOf(line.to) !== -1) {\n        for (let id of this.screen.target) {\n          const objectBox = this.objectList[id]\n          if (objectBox.parents[line.parent]) {\n            target.push(id)\n            this.objectList[id].parents.dotLining = true\n            this.objectList[id].parents[line.parent] = false\n          }\n        }\n      }\n      else {\n        this.objectList[line.to].parents.dotLining = true\n        this.objectList[line.to].parents[line.parent] = false\n      }\n      this.screen.target = target\n    },\n    async lineEnd(e) {\n      if (e.which === 1) {\n        const p = this.lineStartPlace,\n            c = this.lineClearPlace,\n            targetList = this.screen.target,\n            dotLining = this.keyList.dotLining\n        this.clearDotLining()\n        if (p) {\n          if (e.target.title === c || !dotLining) {\n            if (targetList.length)\n              for (let id of targetList) {\n                this.objectList[id].parents[c] = true\n              }\n            else\n              this.objectList[p].parents[c] = true\n          }\n          else {\n            if (c) {\n              const clearKey = new Place(c),\n                  target = await yin.get(clearKey),\n                  key = target._schemaMix[clearKey.key]\n              if (key.type === 'Array') {\n                if (targetList.length)\n                  for (let id of targetList) {\n                    await target[clearKey.key].remove(new Place(id))\n                  }\n                else\n                  await target[clearKey.key].remove(p)\n              }\n              //  else if (yin.structureType.indexOf(key.type) !== -1) {\n              else {\n                delete target[clearKey.key]\n                await target._save()\n              }\n            }\n            if (p && e.target.title) {\n              const k = new Place(e.target.title)\n              const target = await yin.get(k),\n                  key = target._schemaMix[k.key]\n              if (key.type === 'Array') {\n                if (targetList.length)\n                  for (let id of targetList) {\n                    await target[k.key].push(id)\n                  }\n                else\n                  await target[k.key].push(p)\n              }\n              else {\n                target[k.key] = p\n                await target._save()\n              }\n              if (this.objectList[p])\n                this.objectList[p].parents[e.target.title] = true\n            }\n          }\n        }\n      }\n    },\n    inClass(dom, c) {\n      console.log({dom}, dom.classList)\n      if (dom !== document.body) {\n        if (dom.classList.includes(c))\n          return true\n        return this.inClass(dom.parentElement, c)\n      }\n      return false\n    },\n    clearDotLining() {\n      const p = this.lineStartPlace\n      this.lineStartPlace = false\n      this.lineClearPlace = false\n      if (p && this.objectList[p]?.parents)\n        if (this.screen.target.length)\n          for (let id of this.screen.target)\n            delete this.objectList[id].parents.dotLining\n        else\n          delete this.objectList[p].parents.dotLining\n\n      delete this.keyList.dotLining\n      // console.log(this.selectNowPlace)\n      if (this.selectStartPlace && this.selectNowPlace === null) {\n        /**\n         * 空白点击\n         */\n        this.screen.target = []\n        this.screen.targetPlace = null\n      }\n      this.selectStartPlace = null\n      this.selectNowPlace = null\n      delete this.screen.menu\n\n    },\n    lining(e) {\n      // console.log(e)\n      if (this.lineStartPlace) {\n        e.preventDefault()\n        delete this.screen.menu\n\n        /**\n         * 连线\n         */\n        this.keyList.dotLining = {\n          left: e.x + this.screen.left,\n          right: e.x + this.screen.left,\n          dotY: e.y + this.screen.top\n        }\n      }\n      else if (this.selectStartPlace) {\n        /**\n         * 选择\n         */\n        e.preventDefault()\n        delete this.screen.menu\n        this.screen.target = []\n        this.selectNowPlace = {x: e.x + this.screen.left, y: e.y + this.screen.top}\n\n        const sb = {\n          top: Math.min(this.selectStartPlace.y, this.selectNowPlace.y),\n          left: Math.min(this.selectStartPlace.x, this.selectNowPlace.x),\n          bottom: Math.max(this.selectStartPlace.y, this.selectNowPlace.y),\n          right: Math.max(this.selectStartPlace.x, this.selectNowPlace.x)\n        }\n\n        // console.time('selectLining')\n\n        for (let place in this.objectList) {\n          if (!/^_NodeSkip\\./.test(place)) {\n            const b = this.objectList[place],\n                bb = {\n                  top: sb.top - b.height,\n                  bottom: sb.bottom + b.height,\n                  left: sb.left - b.width,\n                  right: sb.right + b.width\n                }\n\n            if (b.top > bb.top && b.bottom < bb.bottom && b.left > bb.left && b.right < bb.right)\n              this.screen.target.push(place)\n          }\n        }\n        // console.timeEnd('selectLining')\n      }\n    },\n    // backgroundClick() {\n    //   console.log('>>>>>>>>')\n    //   this.screen.target = []\n    // },\n    hoverLine(d, e) {\n      if (d.parent !== 'dotLining' && !this.selectStartPlace) {\n        if (this.screen.target?.indexOf(d.to) !== -1) {\n          for (let id of this.screen.target) {\n            for (let i in this.lines) {\n              const line = this.lines[i]\n              if (line.to === id && line.parent === d.parent)\n                line.hover = true\n            }\n          }\n        }\n        else {\n          d.hover = true\n        }\n      }\n    },\n    outLine(d, e) {\n      for (let i in this.lines) {\n        const line = this.lines[i]\n        line.hover = false\n      }\n    },\n    selectStart(e) {\n      if (!this.lineStartPlace) {\n        this.selectStartPlace = {x: e.x + this.screen.left, y: e.y + this.screen.top}\n      }\n    },\n\n    /**\n     * 屏幕拖拽\n     * 此功能已废弃，点击卡片时自动滚动显然更好用\n     * 拦截按键还可能引发意外\n     * @param e\n     */\n    // dragStart(e) {\n    //   if (this.space)\n    //     this.drag = {\n    //       x: e.screenX,\n    //       y: e.screenY,\n    //       tableX: this.screen.left,\n    //       tableY: this.screen.top\n    //     }\n    // },\n    // dragging(e) {\n    //   e.preventDefault();\n    //   if (this.drag.x) {\n    //     this.$refs.table.scrollLeft = this.drag.tableX - (e.screenX - this.drag.x)\n    //     this.$refs.table.scrollTop = this.drag.tableY - (e.screenY - this.drag.y)\n    //   }\n    // },\n    // dragEnd(e) {\n    //   this.drag = {}\n    // },\n    // keydown(ev) {\n    //   if (ev.code === 'Space') {\n    //     if (ev.target.nodeName == 'BODY') {\n    //       ev.preventDefault()\n    //       this.space = true\n    //     }\n    //   }\n    // },\n    // keyup(ev) {\n    //   if (ev.code === 'Space') {\n    //     this.space = false\n    //   }\n    // },\n    /**\n     * 显示区域刷新\n     */\n    screenCtrl() {\n      const table = this.$refs.table\n      this.screen.left = table.scrollLeft\n      this.screen.top = table.scrollTop\n      this.screen.width = table.scrollWidth\n      this.screen.height = table.scrollHeight\n      // Object.assign(this.screen, {\n      //   /**\n      //    * 移动端body向上滑动时标题栏会变小，菜单栏会隐藏\n      //    * 本想按这个进行适配，但是移动端body上的fixed会失效\n      //    * window上的scroll事件并不总能激活，非常蛋疼\n      //    * 现在只能搞个框，在框里面滚动\n      //    * 加了个全屏，先凑合用吧\n      //    */\n      //   // left: window.scrollX,\n      //   // top: window.scrollY,\n      //   // width: window.visualViewport.width,\n      //   // height: window.visualViewport.height,\n      //   left: table.scrollLeft,\n      //   top: table.scrollTop,\n      //   width: table.scrollWidth,\n      //   height: table.scrollHeight,\n      //   timer: this.screen.timer,\n      //   target: this.screen.target || [],\n      //   events: this.screen.events || {},\n      //   targetPlace: this.screen.targetPlace\n      // })\n    },\n    fullscreen() {\n      if (this.isFullscreen)\n        document.exitFullscreen()\n      else\n        this.$refs.table.requestFullscreen()\n      this.isFullscreen = !this.isFullscreen\n    },\n    makeTarget(v, _v) {\n      setTimeout(() => {\n        if (v && v.length === 1 && v[0] !== _v[0]) {\n          const dot = document.getElementById(this.screen.target[0])?.getBoundingClientRect()\n          if (dot) {\n            const s = this.screen, sw = this.$refs.table.clientWidth, sh = this.$refs.table.clientHeight,\n                option = {behavior: 'smooth'} as any,\n                padding = sw > 1024 ? 55 : 6,\n                toTop = dot.top + s.top - padding,\n                toBottom = dot.bottom + s.top - sh + padding,\n                toLeft = dot.left + s.left - padding,\n                toRight = dot.right - sw + s.left + padding\n            // console.log('y', dot.top, sh)\n            // console.log('r', dot.right, sw)\n\n\n            // if (dot.height < (sh - padding * 2)) {\n            /**\n             * 上下滚动\n             */\n            if (dot.height < sh) {\n              if (dot.top < 0)\n                option.top = toTop\n              else if (dot.bottom > sh)\n                option.top = toBottom\n            }\n            else {\n              if (dot.bottom < 0)\n                option.top = toTop\n              else if (dot.top < 0 && dot.bottom < sh)\n                option.top = toBottom\n              else if (dot.top < 0 && dot.bottom > sh) {\n                // console.log('middle')\n              }\n              else if (dot.top > 0)\n                option.top = toTop\n            }\n\n            /**\n             * 左右滚动\n             */\n            if (dot.width < sw) {\n              if (dot.left < 0)\n                option.left = toLeft\n              else if (dot.right > sw)\n                option.left = toRight\n            }\n            else {\n              if (dot.right < 0)\n                option.left = toLeft\n              else if (dot.left < 0 && dot.right < sw)\n                option.left = toRight\n              else if (dot.left < 0 && dot.right > sw) {\n                // console.log('middle')\n              }\n              else if (dot.left > 0)\n                option.left = toLeft\n            }\n            // if (dot.left < 0)\n            //   option.left = dot.left + s.left - padding\n            // if (dot.right > sw) {\n            //   if (dot.width < sw)\n            //     option.left = dot.right - sw + s.left + padding\n            //   else\n            //     option.left = dot.left + s.left - padding\n            // }\n            // console.log(option)\n            if (option.left || option.top) {\n              this.$refs.table.scroll(option)\n              // this.screen.timer = Date.now()\n            }\n          }\n        }\n      }, 100)\n    },\n    async menuChange(menu, _menu) {\n      if (menu) {\n        this.removeEvents()\n        const place = new Place(menu.target), _place = _menu && new Place(_menu.target)\n        if (place.key) this.screen.target = [place['module.id'].valueOf(), menu.target]\n        else if (_place && _place.key || !this.screen.target.includes(menu.target)) this.screen.target = [menu.target]\n\n        await nextTick()\n        setTimeout(() => {\n          const menuBox = this.$refs.menu.$el,\n              mr = menu.x + menuBox.clientWidth,\n              mb = menu.y + menuBox.clientHeight,\n              s = this.screen,\n              sw = this.$refs.table.clientWidth,\n              sh = this.$refs.table.clientHeight,\n              option = {behavior: 'smooth'} as any\n\n          if (mr > s.left + sw) {\n            option.left = mr - sw + 13\n          }\n\n          if (mb > s.top + sh) {\n            option.top = mb - sh + 13\n          }\n\n\n          if (option.left || option.top) {\n            this.$refs.table.scroll(option)\n          }\n        }, 100)\n\n\n      }\n      else\n        this.listenEvents()\n    },\n    async refChange(ref) {\n      if (ref) {\n        for (let id of ref) {\n          this.screen.events[id] = 'ref'\n        }\n        // if (ref.length)\n        //   await navigator.clipboard.writeText(ref)\n      }\n    },\n    listenEvents() {\n      document.addEventListener('mouseup', this.lineEnd)\n      document.addEventListener('mousemove', this.lining)\n    },\n    removeEvents() {\n      document.removeEventListener('mouseup', this.lineEnd)\n      document.removeEventListener('mousemove', this.lining)\n      // window.removeEventListener('scroll', this.screenCtrl)\n      // window.removeEventListener('keydown', this.keydown)\n      // window.removeEventListener('keyup', this.keyup)\n    },\n    copy(e) {\n      const selected = document.getSelection().type !== 'Caret';\n      if (!selected && this.screen.target.length) {\n        this.screen.refs = this.screen.target\n        e.clipboardData.setData('text', this.screen.target)\n        e.preventDefault()\n      }\n      if (selected)\n        this.screen.refs = []\n    },\n    async cut(e) {\n      const selected = document.getSelection().type !== 'Caret';\n      if (!selected && this.screen.target.length) {\n        this.screen.refs = this.screen.target\n        e.clipboardData.setData('text', this.screen.target)\n\n        for (let id of this.screen.target) {\n          const node = this.objectList[id]\n          if (node && node.parent) {\n            await nextTick()\n            const parent = await yin.get(node.parent)\n            await parent[node.parent.key].remove(id)\n          }\n        }\n        e.preventDefault()\n      }\n      if (selected)\n        this.screen.refs = []\n    },\n    async paste(e) {\n      if (this.screen.targetPlace) {\n        e.preventDefault()\n        const p = new Place(this.screen.targetPlace),\n            parent = await yin.get(p),\n            key = parent._schemaMix[p.key],\n            paste = e.clipboardData.getData(\"text\"),\n            els = [];\n        let refs = paste.split(','),\n            _refs = this.screen.refs;\n\n        if (key.type !== 'Array') {\n          if (refs.length)\n            refs.length = 1\n          if (_refs.length)\n            _refs = [this.screen.refs[0]]\n        }\n        for (let id of refs) {\n          try {\n            const object = await yin.get(id)\n            els.push(object)\n          }\n          catch (e) {\n          }\n        }\n        if (!els.length && _refs) {\n          for (let id of _refs) {\n            try {\n              const object = await yin.get(id)\n              els.push(object)\n            }\n            catch (e) {\n            }\n          }\n        }\n        if (els.length) {\n          if (key.type === 'Array') {\n            for (let object of els) {\n              await parent[p.key].push(object)\n            }\n          }\n          else {\n            parent[p.key] = els[0]\n            await parent._save()\n          }\n        }\n      }\n    },\n    panelCtrl(panel: string) {\n      this.panel === panel ? this.panel = '' : this.panel = panel\n    }\n  },\n  mounted() {\n    this.init()\n    this.listenEvents()\n    document.addEventListener('copy', this.copy)\n    document.addEventListener('cut', this.cut)\n    document.addEventListener('paste', this.paste)\n  },\n  watch: {\n    objectList: {\n      handler: 'makeNode',\n      deep: true\n    },\n    keyList: {\n      handler: 'makeNode',\n      deep: true\n    },\n    'screen.target': 'makeTarget',\n    'screen.menu': 'menuChange',\n    'screen.refs': 'refChange'\n  },\n  beforeUnmount() {\n    clearInterval(this.nodeTimer)\n    this.removeEvents()\n    document.removeEventListener('copy', this.copy)\n    document.removeEventListener('cut', this.cut)\n    document.removeEventListener('paste', this.paste)\n    yin.removeEvent('ObjectEvents')\n  }\n})\n</script>\n\n<style scoped lang=\"less\">\n.nodeTree {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: scroll;\n  background-color: var(--color-background);\n\n  &::-webkit-scrollbar {\n    display: none\n  }\n\n  .nodes {\n    padding: 21px 21px 55px 21px;\n    display: flex;\n  }\n\n  .nodeLines {\n    position: absolute;\n    z-index: 0;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n\n    transition: all 1s;\n\n    .line {\n      transition: stroke-width 200ms;\n    }\n  }\n\n\n  .nodeFns {\n    position: fixed;\n    top: 21px;\n    right: 21px;\n    z-index: 1000;\n    background-color: var(--color-background);\n    //padding: 0;\n    //box-sizing: border-box;\n    //border-radius: var(--border-radius);\n    //overflow: hidden;\n    //display: flex;\n    //justify-content: space-between;\n\n    .fns {\n      box-shadow: 0 0 13px var(--color-shadow);\n    }\n\n  }\n\n  .nodeInfo {\n    position: fixed;\n    z-index: 0;\n    top: 0;\n    right: 0;\n    user-select: none;\n    opacity: 0.4;\n  }\n\n  .panel {\n    position: fixed;\n    z-index: 1000;\n    background-color: white;\n    border: var(--border);\n    border-radius: var(--border-radius);\n    right: 21px;\n    top: 68px;\n    bottom: 21px;\n    max-width: 38vw;\n    min-width: 350px;\n  }\n}\n\n\n</style>\n"],"names":["_hoisted_1","_hoisted_2","_createElementVNode","_hoisted_3","AddCircleOutlineFilled","defineComponent","_ctx","_cache","_openBlock","_createElementBlock","ContentCopyFilled","CopyAllFilled","DashboardRound","DeleteOutlineFilled","ForkLeftFilled","FullscreenExitFilled","FullscreenFilled","RampRightFilled","_hoisted_4","_hoisted_5","_hoisted_6","SaveAllOutlined","UploadOutlined","_sfc_render","_sfc_main$8","YinMenuItem","YinMenu","yin","node","event","id","p","list","_a","Place","_resolveComponent","_createBlock","_component_yin_menu","_createSlots","_withCtx","_createVNode","_component_yin_menu_item","$event","_withModifiers","_component_DeleteOutlineFilled","_component_CopyAllFilled","_createTextVNode","_component_ForkLeftFilled","_component_ContentCopyFilled","_component_DashboardRound","_toDisplayString","_sfc_main$7","place","key","model","_b","_Fragment","_createCommentVNode","_component_RampRightFilled","_component_AddCircleOutlineFilled","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_renderList","_sfc_main$6","useNotification","i","all","changed","object","_component_n_button","_sfc_main$5","_component_n_button_group","value","_sfc_main$4","InputSchemaLite","res","_component_input_schema_lite","_sfc_main$3","CodeJavaScript","blockMatch","blockList","textMatch","blockFirst","text","script","block","_component_code_java_script","_sfc_main$2","DialogScript","DialogSchema","TinyRadio","yinCab","info","v","_v","_withScopeId","_hoisted_12","_hoisted_13","_hoisted_14","_component_n_input","c","_component_dialog_schema","_component_dialog_script","args","_hoisted_15","_sfc_main$1","NFormItemRow","NInputGroup","NButton","NTabs","NInput","NTabPane","n","_pushScopeId","_popScopeId","_component_n_tabs","_component_n_h4","_component_n_tab_pane","_component_n_form_item_row","_component_n_input_group","_sfc_main","YinCloudLogin","YinBigModel","SaveAll","YinMenuStructure","YinMenuObject","computed","yinObject","t","pTitle","nextTick","title","parent","tx","ty","ox","oy","mx","my","height","width","m","br","r","yr","ctx","__publicField","x","y","a1","a2","b1","b2","c1","c2","line","target","targetList","dotLining","clearKey","k","dom","sb","b","bb","d","e","table","dot","s","sw","sh","option","padding","toTop","toBottom","toLeft","toRight","menu","_menu","_place","menuBox","mr","mb","ref","selected","paste","els","refs","_refs","panel","_component_YinObject","_component_n_icon","_component_fullscreen_exit_filled","_component_fullscreen_filled","_component_save_all","_component_yin_cloud_login","_component_yin_big_model","_component_yin_menu_structure","_component_yin_menu_object","_normalizeStyle","_c"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10]}