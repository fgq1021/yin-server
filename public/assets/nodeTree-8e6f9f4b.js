var ie=Object.defineProperty;var le=(e,t,n)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var S=(e,t,n)=>(le(e,typeof t!="symbol"?t+"":t,n),n);import{d as j,o,c as h,j as m,_ as D,C as W,z as w,P,r as v,a as b,m as K,w as i,i as d,t as g,b as C,h as p,B as M,F as A,l as z,u as J,I as re,D as ae,E as H,G as ue,p as q,k as G,g as ce,e as he,f as de,y as T,H as pe,A as R,q as N}from"./index-309f0393.js";import{Y as Q}from"./yinMenuItem-25df86b3.js";import{b as me,N as fe,a as ve}from"./Tabs-c7a3a444.js";const ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ge=m("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8z",fill:"currentColor"},null,-1),_e=[ge],be=j({name:"AddCircleOutlineFilled",render:function(t,n){return o(),h("svg",ye,_e)}}),we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ke=m("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",fill:"currentColor"},null,-1),Ce=[ke],X=j({name:"ContentCopyFilled",render:function(t,n){return o(),h("svg",we,Ce)}}),Fe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},$e=m("path",{d:"M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H9V4h9v12zM3 15v-2h2v2H3zm0-5.5h2v2H3v-2zM10 20h2v2h-2v-2zm-7-1.5v-2h2v2H3zM5 22c-1.1 0-2-.9-2-2h2v2zm3.5 0h-2v-2h2v2zm5 0v-2h2c0 1.1-.9 2-2 2zM5 6v2H3c0-1.1.9-2 2-2z",fill:"currentColor"},null,-1),Ee=[$e],Z=j({name:"CopyAllFilled",render:function(t,n){return o(),h("svg",Fe,Ee)}}),je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Le=m("path",{d:"M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zm0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1zm10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zM13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1z",fill:"currentColor"},null,-1),Be=[Le],x=j({name:"DashboardRound",render:function(t,n){return o(),h("svg",je,Be)}}),Me={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ae=m("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z",fill:"currentColor"},null,-1),De=[Ae],ee=j({name:"DeleteOutlineFilled",render:function(t,n){return o(),h("svg",Me,De)}}),Pe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Se=m("path",{d:"M9.41 15.59L8 17l-4-4l4-4l1.41 1.41L7.83 12c1.51-.33 3.73.08 5.17 1.36V6.83l-1.59 1.59L10 7l4-4l4 4l-1.41 1.41L15 6.83V21h-2v-4c-.73-2.58-3.07-3.47-5.17-3l1.58 1.59z",fill:"currentColor"},null,-1),ze=[Se],te=j({name:"ForkLeftFilled",render:function(t,n){return o(),h("svg",Pe,ze)}}),Oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Te=m("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z",fill:"currentColor"},null,-1),Ne=[Te],He=j({name:"FullscreenExitFilled",render:function(t,n){return o(),h("svg",Oe,Ne)}}),Ve={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Re=m("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z",fill:"currentColor"},null,-1),Ie=[Re],Ue=j({name:"FullscreenFilled",render:function(t,n){return o(),h("svg",Ve,Ie)}}),Ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},We=m("path",{d:"M11 21h2V6.83l1.59 1.59L16 7l-4-4l-4 4l1.41 1.41L11 6.83V9c0 4.27-4.03 7.13-6 8.27l1.46 1.46C8.37 17.56 9.9 16.19 11 14.7V21z",fill:"currentColor"},null,-1),Ke=[We],Je=j({name:"RampRightFilled",render:function(t,n){return o(),h("svg",Ye,Ke)}}),qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ge=m("path",{d:"M17 6H8a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h11c1.1 0 2-.9 2-2v-9l-4-4zm2 13H8V8h8.17L19 10.83V19z",fill:"currentColor"},null,-1),Qe=m("path",{d:"M9 9h6v2H9z",fill:"currentColor"},null,-1),Xe=m("circle",{cx:"13.5",cy:"15.5",r:"2.5",fill:"currentColor"},null,-1),Ze=m("path",{d:"M2 4a2 2 0 0 1 2-2h10v2H4v10H2V4z",fill:"currentColor"},null,-1),xe=[Ge,Qe,Xe,Ze],et=j({name:"SaveAllOutlined",render:function(t,n){return o(),h("svg",qe,xe)}}),tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},nt=m("path",{d:"M9 16h6v-6h4l-7-7l-7 7h4v6zm3-10.17L14.17 8H13v6h-2V8H9.83L12 5.83zM5 18h14v2H5z",fill:"currentColor"},null,-1),st=[nt],ot=j({name:"UploadOutlined",render:function(t,n){return o(),h("svg",tt,st)}});const it={},lt={class:"nodeMenu"},rt={class:"targetBox"},at={class:"itemList"};function ut(e,t){return o(),h("div",lt,[m("div",rt,[W(e.$slots,"target")]),m("div",at,[W(e.$slots,"default")])])}const ne=D(it,[["render",ut]]),ct=j({name:"yinMenuObject",components:{ForkLeftFilled:te,YinMenuItem:Q,YinMenu:ne,DeleteOutlineFilled:ee,CopyAllFilled:Z,ContentCopyFilled:X,DashboardRound:x},props:["screen","objectList","right"],data(){return{object:{},parent:null,key:null,objectNode:null,inArray:!0}},methods:{async init(){try{this.object=await w.get(this.screen.menu.target);const e=this.objectList[this.screen.menu.target];this.objectNode=e,e&&(this.parent=await w.get(e.parent),this.key=this.parent._schemaMix[e.parent.key],this.inArray=this.key.type==="Array")}catch{}},putEvent(e){this.screen.events[this.screen.menu.target]=e},putEvents(e){for(let t of this.screen.target)this.screen.events[t]=e},async putParentsEvents(e){for(let t of this.screen.target){const n=this.objectList[t];if(n.parents)for(let s in n.parents)this.screen.events[s]=e}},samePlace(){var t;const e=[];for(let n of this.screen.target){const s=this.objectList[n];s&&((t=s.parent)==null?void 0:t.valueOf())===this.screen.targetPlace&&e.push(n)}return e},putEventsAtSamePlace(e){const t=this.samePlace();for(let n of t)this.screen.events[n]=e},putPlaceEvent(e){this.screen.events[this.objectNode.parent]=e},async putPlaceEvents(e){if(this.objectNode)for(let t in this.objectNode.parents||{})this.screen.events[t]=e;else for(let t of this.object._parents)this.screen.events[new P(this.object._name,t)]=e},removeEvent(){this.screen.events={}},async remove(){for(let e of this.screen.target)await(await w.get(e))._delete();delete this.screen.menu,this.removeEvent()},reference(){this.screen.refs=this.screen.target,delete this.screen.menu,this.removeEvent()},async exportObject(){const e=this.samePlace();for(let t of e)await this.parent[this.key.name].remove(t);this.reference()},async makeCopy(){const e=this.samePlace();for(let t of e)try{await this.parent[this.key.name].create(await w.get(t))}catch{}},dashboard(){window.open(`/#/dashboard/${this.screen.menu.target}`),delete this.screen.menu}},watch:{"screen.menu.target":"init"},mounted(){this.init()}}),ht={class:"main"},dt={style:{"font-size":"smaller"}},pt={key:0},mt={key:0},ft={key:1};function vt(e,t,n,s,u,r){const a=v("DeleteOutlineFilled"),l=v("yin-menu-item"),c=v("CopyAllFilled"),f=v("ForkLeftFilled"),y=v("ContentCopyFilled"),L=v("DashboardRound"),_=v("yin-menu");return o(),b(_,null,K({default:i(()=>[p(l,{onMouseover:t[0]||(t[0]=k=>{e.putEvents("delete"),e.putParentsEvents("delete")}),onMouseout:e.removeEvent,onClick:M(e.remove,["stop"])},{icon:i(()=>[p(a)]),default:i(()=>[d(" 删除 ")]),_:1},8,["onMouseout","onClick"]),p(l,{onMouseover:t[1]||(t[1]=k=>e.putEvents("ref")),onMouseout:e.removeEvent,onClick:M(e.reference,["stop"])},{icon:i(()=>[p(c)]),info:i(()=>[d(" 对象只是被引用到不同的位置 ")]),default:i(()=>[d(" 引用（复制） ")]),_:1},8,["onMouseout","onClick"]),e.inArray?(o(),b(l,{key:0,onMouseover:t[2]||(t[2]=k=>{e.putEventsAtSamePlace("update"),e.putPlaceEvent("update")}),onMouseout:e.removeEvent,onClick:M(e.exportObject,["stop"])},{icon:i(()=>[p(f)]),info:i(()=>[d("对象|位置 只是不再被引入到该位置")]),default:i(()=>[d(" 引出（剪切） ")]),_:1},8,["onMouseout","onClick"])):(o(),b(l,{key:1,onMouseover:t[3]||(t[3]=k=>{e.putEvent("ref"),e.putPlaceEvent("update")}),onMouseout:e.removeEvent,onClick:M(e.exportObject,["stop"])},{icon:i(()=>[p(f)]),info:i(()=>[d("对象|位置 只是不再被引入到该位置")]),default:i(()=>[d(" 引出（剪切） ")]),_:1},8,["onMouseout","onClick"])),p(l,{onMouseover:t[4]||(t[4]=k=>{e.putEventsAtSamePlace("read"),e.putPlaceEvent("update")}),onMouseout:e.removeEvent,onClick:M(e.makeCopy,["stop"])},{icon:i(()=>[p(y)]),info:i(()=>[e.inArray?(o(),h("span",mt,"为当前位置中被选中的对象创建副本")):(o(),h("span",ft,"*在当前位置创建副本以替换该对象"))]),default:i(()=>[d(" 创建副本 ")]),_:1},8,["onMouseout","onClick"]),p(l,{onMouseover:t[5]||(t[5]=k=>e.putEvent("default")),onMouseout:e.removeEvent,onClick:M(e.dashboard,["stop"])},{icon:i(()=>[p(L)]),info:i(()=>[d("可分享给他人查看或编辑（须登录）")]),default:i(()=>[d(" 控制面板 ")]),_:1},8,["onMouseout","onClick"])]),_:2},[e.object._id?{name:"target",fn:i(()=>[m("p",ht,[d(g(e.object._title)+" ",1),m("span",dt,": "+g(e.object._module.title),1)]),e.screen.target.length>1?(o(),h("p",pt,"... 等 "+g(e.screen.target.length)+"个对象",1)):C("",!0)]),key:"0"}:void 0]),1024)}const yt=D(ct,[["render",vt]]),gt=j({name:"yinMenuStructure",components:{YinMenuItem:Q,YinMenu:ne,DeleteOutlineFilled:ee,CopyAllFilled:Z,ContentCopyFilled:X,DashboardRound:x,ForkLeftFilled:te,RampRightFilled:Je,AddCircleOutlineFilled:be},props:["screen","objectList","right"],data(){return{parent:{},key:{},value:null,models:[]}},computed:{hasObject(){return w.structureType.indexOf(this.key.type)!==-1&&this.key.type!=="Array"&&this.value},hasRefs(){var e;return(e=this.screen.refs)==null?void 0:e.length}},methods:{async init(){try{const e=new P(this.screen.menu.target);if(this.parent=await w.get(this.screen.menu.target),this.key=this.parent._schemaMix[e.key],w.structureType.indexOf(this.key.type)!==-1){try{this.value=await this.parent[e.key]}catch{this.value=null}this.models=await this.parent[e.key].models()}}catch{}},moduleTitle(e=this.key){var t;return["Object","Array"].includes(e.type)?this.parent._module.title:((t=w[e.type])==null?void 0:t.title)||e.type},putEvent(e){this.screen.events[this.screen.menu.target]=e},putChildEvent(e){this.screen.events[this.value._place.valueOf()]=e},putChildrenEvents(e){},removeEvent(){this.screen.events={}},async removeChild(){await this.value._delete(),delete this.screen.menu,this.removeEvent()},referenceChild(){this.screen.refs=[this.value._place.valueOf()],delete this.screen.menu,this.removeEvent()},reference(){},async importObject(){if(this.key.type==="Array")for(let e of this.screen.refs)await this.parent[this.key.name].push(e);else this.parent[this.key.name]=this.screen.refs[0],await this.parent._save();delete this.screen.menu,this.removeEvent()},importHover(){if(this.putEvent("update"),this.key.type==="Array")for(let e of this.screen.refs)this.screen.events[e]="read";else this.screen.events[this.screen.refs[0]]="read"},async importCopyObject(){if(this.key.type==="Array")for(let e of this.screen.refs)await this.parent[this.key.name].create(await w.get(e));else await this.parent[this.key.name].create(await w.get(this.screen.refs[0]));delete this.screen.menu,this.removeEvent()},async exportObject(){await this.parent[this.key.name].remove(this.value._id),this.screen.refs=[this.value._place.valueOf()],delete this.screen.menu,this.removeEvent()},async createObject(e){e?await this.parent[this.key.name].create({_model:e._id}):await this.parent[this.key.name].create(),delete this.screen.menu,this.removeEvent()},dashboard(){window.open(`/#/dashboard/${this.screen.menu.target}`),delete this.screen.menu}},watch:{"screen.menu.target":"init"},mounted(){this.init()}}),_t={class:"main"},bt={style:{"font-size":"smaller"}},wt={key:0},kt={key:1},Ct={key:2},Ft=m("hr",null,null,-1),$t={key:0},Et={key:1},jt={key:0},Lt={key:1},Bt={key:2};function Mt(e,t,n,s,u,r){const a=v("DeleteOutlineFilled"),l=v("yin-menu-item"),c=v("CopyAllFilled"),f=v("RampRightFilled"),y=v("ContentCopyFilled"),L=v("ForkLeftFilled"),_=v("AddCircleOutlineFilled"),k=v("yin-menu");return o(),b(k,null,{target:i(()=>{var F,B;return[m("p",_t,[d(g(e.parent._title)+"."+g(e.key.title)+" ",1),m("span",bt,": "+g(e.moduleTitle(e.key)),1)]),e.key.type==="Array"?(o(),h("p",wt," 共"+g((B=(F=e.value)==null?void 0:F.option)==null?void 0:B.total)+"个对象 ",1)):e.hasObject?(o(),h("p",kt,g(e.value._title),1)):(o(),h("p",Ct," 未创建 "))]}),default:i(()=>[e.hasObject?(o(),h(A,{key:0},[p(l,{onMouseover:t[0]||(t[0]=F=>{e.putEvent("delete"),e.putChildEvent("delete")}),onMouseout:e.removeEvent,onClick:e.removeChild},{icon:i(()=>[p(a)]),info:i(()=>[d("删除该位置的对象")]),default:i(()=>[d(" 删除 "+g(e.value._title||e.value._place)+" ",1)]),_:1},8,["onMouseout","onClick"]),p(l,{onMouseover:t[1]||(t[1]=F=>e.putChildEvent("ref")),onMouseout:e.removeEvent,onClick:e.referenceChild},{icon:i(()=>[p(c)]),info:i(()=>[d("引用该位置的对象")]),default:i(()=>[d(" 引用 "+g(e.value._title||e.value._place)+" ",1)]),_:1},8,["onMouseout","onClick"]),Ft],64)):C("",!0),p(l,{onMouseover:t[2]||(t[2]=F=>e.putEvent("ref")),onMouseout:e.removeEvent,onClick:e.reference},{icon:i(()=>[p(c)]),info:i(()=>[d("引用该位置")]),mate:i(()=>[d("开发中*")]),default:i(()=>[d(" 引用（复制） ")]),_:1},8,["onMouseout","onClick"]),e.hasRefs?(o(),b(l,{key:1,onMouseover:e.importHover,onMouseout:e.removeEvent,onClick:e.importObject},{icon:i(()=>[p(f)]),info:i(()=>[d("对象|位置 只是被引入到该位置,非复制")]),default:i(()=>[d(" 引入（粘贴* | 映射 | 挂载） ")]),_:1},8,["onMouseover","onMouseout","onClick"])):C("",!0),e.hasRefs?(o(),b(l,{key:2,onMouseover:e.importHover,onMouseout:e.removeEvent,onClick:e.importCopyObject},{icon:i(()=>[p(y)]),info:i(()=>[d("在该位置创建引用对象的副本")]),default:i(()=>[d(" 引入副本 ")]),_:1},8,["onMouseover","onMouseout","onClick"])):C("",!0),e.hasObject?(o(),b(l,{key:3,onMouseover:t[3]||(t[3]=F=>{e.putEvent("update"),e.putChildEvent("ref")}),onMouseout:e.removeEvent,onClick:e.exportObject},{icon:i(()=>[p(L)]),info:i(()=>[d("对象|位置 只是不再被引入到该位置")]),default:i(()=>[d(" 引出（剪切） ")]),_:1},8,["onMouseout","onClick"])):C("",!0),p(l,{onMouseover:t[4]||(t[4]=F=>e.putEvent("update")),onMouseout:e.removeEvent,onClick:t[5]||(t[5]=F=>e.createObject())},K({icon:i(()=>[p(_)]),default:i(()=>[e.hasObject?(o(),h("span",$t,"重新创建")):(o(),h("span",Et,"新建"))]),_:2},[e.hasObject?{name:"info",fn:i(()=>[d("顶替现有对象 "+g(e.value._title||e.value._place),1)]),key:"0"}:void 0,e.parent._id?{name:"mate",fn:i(()=>[e.models.length>1?(o(),h("span",jt," > ")):e.models.length===1?(o(),h("span",Lt,g(e.models[0]._title)+":"+g(e.moduleTitle(e.key)),1)):(o(),h("span",Bt,"无模型"+g(e.parent._module.title),1))]),key:"1"}:void 0,e.models.length>1?{name:"children",fn:i(()=>[(o(!0),h(A,null,z(e.models,F=>(o(),b(l,{onClick:M(B=>e.createObject(F),["stop"])},{mate:i(()=>[d(":"+g(e.moduleTitle(e.key)),1)]),default:i(()=>[d(g(F._title)+" ",1)]),_:2},1032,["onClick"]))),256))]),key:"2"}:void 0]),1032,["onMouseout"])]),_:1})}const At=D(gt,[["render",Mt]]),Dt=j({name:"saveAll",components:{UploadOutlined:ot},data(){return{loading:!1,msg:"",message:J()}},methods:{async save(){this.loading=!0;try{const e=await w.saveAll((t,n,s,u)=>{this.msg=(s?"保存":"扫描")+` : ${u._title} #${u._place} - ${t}/${n}`});e.length?this.message.success({title:`${e.length}个成功保存`,duration:3e3}):this.message.warning({title:"没有未保存的对象",duration:2e3})}catch(e){this.message.error({title:`${e.err.length}个未成功保存`,content:`${e.list.length}个成功保存`,duration:2500,keepAliveOnHover:!0})}this.loading=!1}}}),Pt={key:0},St={key:1};function zt(e,t,n,s,u,r){const a=v("n-button");return o(),b(a,{onClick:e.save,loading:e.loading},{default:i(()=>[e.loading?(o(),h("p",Pt,g(e.msg),1)):(o(),h("p",St,"保存"))]),_:1},8,["onClick","loading"])}const Ot=D(Dt,[["render",zt]]),Tt=j({name:"tinyRadio",props:["modelValue","values","names"]});function Nt(e,t,n,s,u,r){const a=v("n-button"),l=v("n-button-group");return o(),b(l,null,{default:i(()=>[(o(!0),h(A,null,z(e.values,(c,f)=>(o(),b(a,{size:"tiny",secondary:"",type:e.modelValue===c?"primary":"default",onClick:y=>e.$emit("update:modelValue",c)},{default:i(()=>[d(g(e.names&&e.names[f]||c),1)]),_:2},1032,["type","onClick"]))),256))]),_:1})}const Ht=D(Tt,[["render",Nt]]),Vt=j({name:"dialogSchema",components:{InputSchemaLite:re},props:["object","target"],data(){return{pre:"",after:"",msg:""}},methods:{makeContent(){if(this.object.content){let e=[];this.object.content.match(/(\|.+\|.+\|.+\|.+\|)+/g)?(this.msg="",e=this.object.content.split(/\|.+\|.+\|.+\|.+\|/)):this.object.content.match(/(.+\|.+\|.+\|.+)+/g)?(e=this.object.content.split(/.+\|.+\|.+\|.+/),this.msg="此生成存在问题，请注意使用"):this.msg="未生成出可使用内容。。。",e.length&&(this.pre=e[0],this.after=e[e.length-1])}else this.pre="生成中..."},_makeContent(){if(this.object.content)try{JSON.parse(this.object.content),this.pre="",this.after=""}catch{this.pre=this.object.content.replace(/```json[\s\S]+/,""),/```json[\s\S]+```/.test(this.object.content)&&(this.after=this.object.content.replace(/[\s\S]+```/,""))}else this.pre="生成中..."},async apply(){this.target._schema=[],this.target._schema=this.object.result,await this.target._save()}},watch:{"object.content"(){this.makeContent(),this.$emit("update")}},mounted(){this.makeContent()}});const Rt={class:"dialog"},It={class:"text"},Ut={class:"text"},Yt={class:"fns"};function Wt(e,t,n,s,u,r){const a=v("input-schema-lite"),l=v("n-button");return o(),h("div",Rt,[m("div",It,g(e.pre),1),this.object.result instanceof Array?(o(),b(a,{key:0,"model-value":{_schema:this.object.result}},null,8,["model-value"])):C("",!0),m("div",Ut,g(e.after),1),d(" "+g(e.msg)+" ",1),m("div",Yt,[this.object.result&&this.object.result.length?(o(),b(l,{key:0,onClick:e.apply},{default:i(()=>[d("应用")]),_:1},8,["onClick"])):C("",!0)])])}const Kt=D(Vt,[["render",Wt],["__scopeId","data-v-082afef7"]]),Jt=j({name:"dialogScript",components:{CodeJavaScript:ae},props:["object","target"],data(){return{list:[]}},methods:{makeContent(){if(this.object.content){this.list=[];const e=this.object.content.match(/```[\s\S]*?```\s?/g);if(e){const t=e.map(u=>u.match(/```javascript\n([\s\S]*?)\n```\s?/)[1]),n=this.object.content.split(/```[\s\S]*?```\s?/);let s=!1;for(let u in n){const r=n[u];u==="0"&&r===""&&(s=!0),s?this.list.push({type:"block",content:t[u]},{type:"text",content:r}):this.list.push({type:"text",content:r},{type:"block",content:t[u]})}JSON.stringify(n)!=='["",""]'&&n[n.length-1]===""&&this.list.push({type:"block",content:t[t.length-1]})}else this.list=[{type:"text",content:this.object.content}]}else this.pre="生成中..."},async apply(e){try{await w.readScript(this.target._place),await w.updateScript(this.target._place,e)}catch{await w.createScript(this.target._place,e)}}},watch:{"object.content"(){this.makeContent(),this.$emit("update")}},mounted(){this.makeContent()}});const qt={class:"dialog"},Gt={key:0,class:"text"},Qt={key:1,class:"code"};function Xt(e,t,n,s,u,r){const a=v("code-java-script"),l=v("n-button");return o(),h("div",qt,[(o(!0),h(A,null,z(e.list,c=>(o(),h(A,null,[c.content?(o(),h(A,{key:0},[c.type==="text"?(o(),h("div",Gt,g(c.content),1)):(o(),h("div",Qt,[p(a,{modelValue:c.content,"onUpdate:modelValue":f=>c.content=f},null,8,["modelValue","onUpdate:modelValue"]),p(l,{class:"fn",onClick:f=>e.apply(c.content)},{default:i(()=>[d("应用")]),_:2},1032,["onClick"])]))],64)):C("",!0)],64))),256))])}const Zt=D(Jt,[["render",Xt],["__scopeId","data-v-aaec612a"]]),xt=j({name:"yinBigModel",components:{DialogScript:Zt,DialogSchema:Kt,TinyRadio:Ht},inject:["screen"],data(){return{object:{},chat:{},chatList:[],fn:"_schema",commandNow:"",scrollTimer:""}},computed:{chatPlace(){var e;return(e=this.object._place)==null?void 0:e.toKey(this.fn)}},methods:{async init(){this.object={},this.screen.target[0]?(this.object=await w.get(this.screen.target[0]),await this.initChat()):(this.chat={},this.chatList=[])},async initChat(){this.chat={},this.chatList=[];try{this.chat=await H.Command.findOne({_bindPlace:this.chatPlace})}catch{this.chat=await H.Command.create({_bindPlace:this.chatPlace,_bindInstance:w.system.instance,_model:"6528fac4e00c64cc97010db6",reference:{}})}switch(this.fn){case"_schema":this.chat.info=this.object._schema;break;case"script":const e={schema:this.object._schemaMix,script:""};try{e.script=await w.readScript(this.object._place)}catch{}this.chat.info=e;break}await this.chat._save(),this.chatList=await this.chat.commands,await this.chatList.all(),this.$refs.view.scrollTop=this.$refs.view.scrollHeight},async command(){await this.chat.commands.create({content:this.commandNow,isCommand:!0}),this.commandNow="",setTimeout(()=>{this.scrollBottom()},1e3)},scrollBottom(){this.$refs.view.scroll({top:this.$refs.view.scrollHeight,behavior:"smooth"})},async clearChat(){await this.chat._delete(),this.chat={},this.chatList=[]}},watch:{"screen.target"(e,t){e[0]!==t[0]&&this.init()},fn:"initChat"},mounted(){this.init()}});const se=e=>(q("data-v-6213ed29"),e=e(),G(),e),en={class:"yinBigModel"},tn={key:0,class:"mainBox"},nn={class:"title"},sn={key:1,class:"mainBox"},on=se(()=>m("span",null,"载入中",-1)),ln={key:2,class:"mainBox"},rn=se(()=>m("p",null,"请至少选中一个对象",-1)),an=[rn],un={class:"commandLine",ref:"view"},cn={key:0,class:"command"},hn={class:"dialog"},dn={key:1,class:"response"},pn={key:2,class:"dialog"},mn={key:1,class:"msg"},fn={class:"commandInput"};function vn(e,t,n,s,u,r){const a=v("tiny-radio"),l=v("dialog-schema"),c=v("dialog-script"),f=v("n-input");return o(),h("div",en,[e.object._id?(o(),h("div",tn,[m("p",nn,[d(g(e.object._title)+"：",1),m("span",null,g(e.object._module.title),1)]),p(a,{modelValue:e.fn,"onUpdate:modelValue":t[0]||(t[0]=y=>e.fn=y),values:["_schema","script"],names:["结构","脚本"]},null,8,["modelValue"])])):this.screen.target[0]?(o(),h("div",sn,[m("p",null,[d(g(this.screen.target[0])+"：",1),on])])):(o(),h("div",ln,an)),m("div",un,[(o(!0),h(A,null,z(e.chatList,y=>(o(),h(A,null,[y.isCommand?(o(),h("div",cn,[m("div",hn,g(y.content),1)])):(o(),h("div",dn,[e.fn==="_schema"?(o(),b(l,{key:0,object:y,target:e.object,onUpdate:e.scrollBottom},null,8,["object","target","onUpdate"])):e.fn==="script"?(o(),b(c,{key:1,object:y,target:e.object,onUpdate:e.scrollBottom},null,8,["object","target","onUpdate"])):(o(),h("div",pn,g(y.content),1))]))],64))),256)),e.chatList.length?(o(),h("p",{key:0,class:"msg",style:{cursor:"pointer"},onClick:t[1]||(t[1]=(...y)=>e.clearChat&&e.clearChat(...y))},"清空内容")):(o(),h("p",mn,"当前对话为空"))],512),m("div",fn,[p(f,{placeholder:"回车发送指令",type:"textarea",autosize:{minRows:1},value:e.commandNow,"onUpdate:value":t[2]||(t[2]=y=>e.commandNow=y),onKeyup:ue(e.command,["enter"])},null,8,["value","onKeyup"])])])}const yn=D(xt,[["render",vn],["__scopeId","data-v-6213ed29"]]),gn=j({name:"yinAuth",components:{NFormItemRow:me,NInputGroup:ce,NButton:he,NTabs:fe,NInput:de,NTabPane:ve},props:["yinCore"],data(){return{message:J(),_tel:"",code:"",_password:"",confirmPassword:"",device:"",msg:"",time:60,yin:w}},mounted(){this.yinCore&&(this.yin=this.yinCore)}});const oe=e=>(q("data-v-20d4e703"),e=e(),G(),e),_n={class:"yinAuth"},bn=oe(()=>m("p",null,"此时注册的用户将为管理员",-1)),wn={key:1,class:"btn raw"},kn={key:2,class:"btn raw"},Cn=oe(()=>m("p",{class:"title"},"输入手机号自动登录/注册",-1)),Fn={class:"btn raw"};function $n(e,t,n,s,u,r){const a=v("n-h4"),l=v("n-input"),c=v("n-form-item-row"),f=v("n-button"),y=v("n-tab-pane"),L=v("n-input-group"),_=v("n-tabs");return o(),h("div",_n,[m("h3",null,g(e.yin.system.title),1),e.yin.system.uninitialized?(o(),h(A,{key:0},[p(a,null,{default:i(()=>[d("初始化")]),_:1}),bn],64)):C("",!0),p(_,{"default-value":"password",size:"large"},{default:i(()=>[p(y,{name:"password",tab:"密码"},{default:i(()=>[p(c,{label:"手机号"},{default:i(()=>[p(l,{value:e._tel,"onUpdate:value":t[0]||(t[0]=k=>e._tel=k),type:"tel",placeholder:"请输入手机号"},null,8,["value"])]),_:1}),p(c,{label:"密码",feedback:e.msg},{default:i(()=>[p(l,{value:e._password,"onUpdate:value":t[1]||(t[1]=k=>e._password=k),type:"password",center:"",clearable:"",placeholder:"请输入密码"},null,8,["value"])]),_:1},8,["feedback"]),e.register?(o(),b(c,{key:0,label:"确认密码"},{default:i(()=>[p(l,{value:e.confirmPassword,"onUpdate:value":t[2]||(t[2]=k=>e.confirmPassword=k),type:"password",center:"",clearable:"",placeholder:"再次输入密码"},null,8,["value"])]),_:1})):C("",!0),e.register?C("",!0):(o(),h("div",wn,[p(f,{onClick:e.authPassword,block:"",type:"primary"},{default:i(()=>[d("登录")]),_:1},8,["onClick"]),p(f,{onClick:t[3]||(t[3]=k=>e.register=!0),block:"",type:"default"},{default:i(()=>[d("注册")]),_:1})])),e.register?(o(),h("div",kn,[p(f,{onClick:t[4]||(t[4]=k=>e.register=!1),block:"",type:"default"},{default:i(()=>[d("登录")]),_:1}),p(f,{onClick:e.reg,block:"",type:"primary"},{default:i(()=>[d("注册")]),_:1},8,["onClick"])])):C("",!0)]),_:1}),p(y,{name:"code",tab:"验证码"},{default:i(()=>[Cn,p(c,{label:"手机号"},{default:i(()=>[p(l,{value:e._tel,"onUpdate:value":t[5]||(t[5]=k=>e._tel=k),type:"tel",placeholder:"请输入手机号"},null,8,["value"])]),_:1}),p(c,{label:"短信验证码",feedback:e.msg},{default:i(()=>[p(L,null,{default:i(()=>[p(l,{value:e.code,"onUpdate:value":t[6]||(t[6]=k=>e.code=k),center:"",clearable:"",placeholder:"请输入短信验证码",autocomplete:"one-time-code"},null,8,["value"]),e.device?C("",!0):(o(),b(f,{key:0,disabled:e._tel==="",type:"primary",onClick:e.getCode},{default:i(()=>[d(" 发送验证码 ")]),_:1},8,["disabled","onClick"])),e.device&&e.time>0?(o(),b(f,{key:1,disabled:!0,type:"primary"},{default:i(()=>[d(" 已发送("+g(e.time)+") ",1)]),_:1})):C("",!0),e.device&&e.time===0?(o(),b(f,{key:2,type:"primary",onClick:e.getCode},{default:i(()=>[d(" 再次发送 ")]),_:1},8,["onClick"])):C("",!0)]),_:1})]),_:1},8,["feedback"]),m("div",Fn,[p(f,{type:"primary",block:"",onClick:e.auth},{default:i(()=>[d("登录/注册")]),_:1},8,["onClick"])])]),_:1})]),_:1})])}const En=D(gn,[["render",$n],["__scopeId","data-v-20d4e703"]]),jn=j({name:"nodeTree",props:["object"],components:{YinCloudLogin:En,YinBigModel:yn,SaveAll:Ot,FullscreenFilled:Ue,FullscreenExitFilled:He,SaveAllOutlined:et,YinMenuStructure:At,YinMenuObject:yt},provide(){return{objectList:T(()=>this.objectList),keyList:T(()=>this.keyList),screen:T(()=>this.screen),lines:T(()=>this.lines)}},data(){return{root:{},objectList:{},keyList:{},screen:{timer:new Date,target:[],targetPlace:null,events:{},refs:[],node:!0},lines:{},lineStartPlace:null,lineClearPlace:null,selectStartPlace:null,selectNowPlace:null,timer:null,space:!1,drag:{},nodeTimer:"",isFullscreen:!1,panel:"",yinCabMe:{}}},methods:{async init(){w.on("ObjectEvents",(e,t,...n)=>{if(!(n[0]instanceof Error)){const s=t instanceof pe?t._place:t._place["module.id.key"];this.screen.events[s]=e,setTimeout(()=>{delete this.screen.events[s]},100)}}),this.object?this.root=this.object:this.root=this.$yin.me,this.screenCtrl(),await this.makeNode(),this.initCab()},async initCab(){try{await H.start(),this.yinCabMe=H.me}catch{}},refresh(e){this.screen.menu&&this.lineEnd(e),setTimeout(()=>{this.screen.timer=Date.now()},16)},async makeNode(){this.lines={};for(let e in this.objectList){const t=this.objectList[e];for(let n in t.parents)t.parents[n]&&this.pushLine(e,n,this.keyList[n],t)}await R(),this.screen.timer=Date.now()},pushLine(e,t,n,s){if(e&&n&&s){const u=s.left,r=s.dotY,a=n.right,l=n.dotY,c=(a+u)/2,f=(l+r)/2,y=Math.abs(r-l),L=Math.abs(u-a),_=13,k=13,F=y>k*2?k:y/2,B=l>r?F:-F,$=new this.Ctx(e,t);$.moveTo(a,l),y>k*2?(u<=a+_?($.lineTo(a+_-F,l),$.bezierCurveTo(a+_,l,a+_,l,a+_,l-B),$.lineTo(a+_,f+B),$.bezierCurveTo(a+_,f,a+_,f,a+_-F,f),$.lineTo(u-_+F,f),$.bezierCurveTo(u-_,f,u-_,f,u-_,f-B),$.lineTo(u-_,r+B),$.bezierCurveTo(u-_,r,u-_,r,u-_+F,r)):($.lineTo(c-F,l),$.bezierCurveTo(c,l,c,l,c,l-B),$.lineTo(c,r+B),$.bezierCurveTo(c,r,c,r,c+F,r)),$.lineTo(u,r)):L>_*2?($.lineTo(a+_,l),$.bezierCurveTo(c,l,c,r,u-_,r),$.lineTo(u,r)):$.bezierCurveTo(c,l,c,r,u,r),this.lines[$.title]=$}},Ctx:class{constructor(t,n){S(this,"path","");S(this,"hover",!1);S(this,"title","");S(this,"parent","");S(this,"to","");this.title=t+"-"+n,this.parent=n,this.to=t}moveTo(t,n){this.path+="M "+t+","+n+" "}lineTo(t,n){this.path+="L "+t+","+n+" "}bezierCurveTo(t,n,s,u,r,a){this.path+="C "+t+","+n+" "+s+","+u+" "+r+","+a+" "}},lineStart(e){var t;if(e.target.title&&!/^_NodeSkip\./.test(e.target.title)){const n=new P(e.target.title);if(n.id&&(e.preventDefault(),!n.key))if(this.lineStartPlace=n,((t=this.screen.target)==null?void 0:t.indexOf(e.target.title))!==-1)for(let s of this.screen.target)this.objectList[s].parents.dotLining=!0;else this.screen.target=[],this.objectList[n].parents.dotLining=!0}},lineToDrag(e){var n;const t=[];if(this.lineStartPlace=e.to,this.lineClearPlace=e.parent,((n=this.screen.target)==null?void 0:n.indexOf(e.to))!==-1)for(let s of this.screen.target)this.objectList[s].parents[e.parent]&&(t.push(s),this.objectList[s].parents.dotLining=!0,this.objectList[s].parents[e.parent]=!1);else this.objectList[e.to].parents.dotLining=!0,this.objectList[e.to].parents[e.parent]=!1;this.screen.target=t},async lineEnd(e){if(e.which===1){const t=this.lineStartPlace,n=this.lineClearPlace,s=this.screen.target,u=this.keyList.dotLining;if(this.clearDotLining(),t)if(e.target.title===n||!u)if(s.length)for(let r of s)this.objectList[r].parents[n]=!0;else this.objectList[t].parents[n]=!0;else{if(n){const r=new P(n),a=await w.get(r);if(a._schemaMix[r.key].type==="Array")if(s.length)for(let c of s)await a[r.key].remove(new P(c));else await a[r.key].remove(t);else delete a[r.key],await a._save()}if(t&&e.target.title){const r=new P(e.target.title),a=await w.get(r);if(a._schemaMix[r.key].type==="Array")if(s.length)for(let c of s)await a[r.key].push(c);else await a[r.key].push(t);else a[r.key]=t,await a._save();this.objectList[t]&&(this.objectList[t].parents[e.target.title]=!0)}}}},inClass(e,t){return console.log({dom:e},e.classList),e!==document.body?e.classList.includes(t)?!0:this.inClass(e.parentElement,t):!1},clearDotLining(){var t;const e=this.lineStartPlace;if(this.lineStartPlace=!1,this.lineClearPlace=!1,e&&((t=this.objectList[e])!=null&&t.parents))if(this.screen.target.length)for(let n of this.screen.target)delete this.objectList[n].parents.dotLining;else delete this.objectList[e].parents.dotLining;delete this.keyList.dotLining,this.selectStartPlace&&this.selectNowPlace===null&&(this.screen.target=[],this.screen.targetPlace=null),this.selectStartPlace=null,this.selectNowPlace=null,delete this.screen.menu},lining(e){if(this.lineStartPlace)e.preventDefault(),delete this.screen.menu,this.keyList.dotLining={left:e.x+this.screen.left,right:e.x+this.screen.left,dotY:e.y+this.screen.top};else if(this.selectStartPlace){e.preventDefault(),delete this.screen.menu,this.screen.target=[],this.selectNowPlace={x:e.x+this.screen.left,y:e.y+this.screen.top};const t={top:Math.min(this.selectStartPlace.y,this.selectNowPlace.y),left:Math.min(this.selectStartPlace.x,this.selectNowPlace.x),bottom:Math.max(this.selectStartPlace.y,this.selectNowPlace.y),right:Math.max(this.selectStartPlace.x,this.selectNowPlace.x)};for(let n in this.objectList)if(!/^_NodeSkip\./.test(n)){const s=this.objectList[n],u={top:t.top-s.height,bottom:t.bottom+s.height,left:t.left-s.width,right:t.right+s.width};s.top>u.top&&s.bottom<u.bottom&&s.left>u.left&&s.right<u.right&&this.screen.target.push(n)}}},hoverLine(e,t){var n;if(e.parent!=="dotLining"&&!this.selectStartPlace)if(((n=this.screen.target)==null?void 0:n.indexOf(e.to))!==-1)for(let s of this.screen.target)for(let u in this.lines){const r=this.lines[u];r.to===s&&r.parent===e.parent&&(r.hover=!0)}else e.hover=!0},outLine(e,t){for(let n in this.lines){const s=this.lines[n];s.hover=!1}},selectStart(e){this.lineStartPlace||(this.selectStartPlace={x:e.x+this.screen.left,y:e.y+this.screen.top})},screenCtrl(){const e=this.$refs.table;this.screen.left=e.scrollLeft,this.screen.top=e.scrollTop,this.screen.width=e.scrollWidth,this.screen.height=e.scrollHeight},fullscreen(){this.isFullscreen?document.exitFullscreen():this.$refs.table.requestFullscreen(),this.isFullscreen=!this.isFullscreen},makeTarget(e,t){setTimeout(()=>{var n;if(e&&e.length===1&&e[0]!==t[0]){const s=(n=document.getElementById(this.screen.target[0]))==null?void 0:n.getBoundingClientRect();if(s){const u=this.screen,r=this.$refs.table.clientWidth,a=this.$refs.table.clientHeight,l={behavior:"smooth"},c=r>1024?55:6,f=s.top+u.top-c,y=s.bottom+u.top-a+c,L=s.left+u.left-c,_=s.right-r+u.left+c;s.height<a?s.top<0?l.top=f:s.bottom>a&&(l.top=y):s.bottom<0?l.top=f:s.top<0&&s.bottom<a?l.top=y:s.top<0&&s.bottom>a||s.top>0&&(l.top=f),s.width<r?s.left<0?l.left=L:s.right>r&&(l.left=_):s.right<0?l.left=L:s.left<0&&s.right<r?l.left=_:s.left<0&&s.right>r||s.left>0&&(l.left=L),(l.left||l.top)&&this.$refs.table.scroll(l)}}},100)},async menuChange(e,t){if(e){this.removeEvents();const n=new P(e.target),s=t&&new P(t.target);n.key?this.screen.target=[n["module.id"].valueOf(),e.target]:(s&&s.key||!this.screen.target.includes(e.target))&&(this.screen.target=[e.target]),await R(),setTimeout(()=>{const u=this.$refs.menu.$el,r=e.x+u.clientWidth,a=e.y+u.clientHeight,l=this.screen,c=this.$refs.table.clientWidth,f=this.$refs.table.clientHeight,y={behavior:"smooth"};r>l.left+c&&(y.left=r-c+13),a>l.top+f&&(y.top=a-f+13),(y.left||y.top)&&this.$refs.table.scroll(y)},100)}else this.listenEvents()},async refChange(e){if(e)for(let t of e)this.screen.events[t]="ref"},listenEvents(){document.addEventListener("mouseup",this.lineEnd),document.addEventListener("mousemove",this.lining)},removeEvents(){document.removeEventListener("mouseup",this.lineEnd),document.removeEventListener("mousemove",this.lining)},copy(e){const t=document.getSelection().type!=="Caret";!t&&this.screen.target.length&&(this.screen.refs=this.screen.target,e.clipboardData.setData("text",this.screen.target),e.preventDefault()),t&&(this.screen.refs=[])},async cut(e){const t=document.getSelection().type!=="Caret";if(!t&&this.screen.target.length){this.screen.refs=this.screen.target,e.clipboardData.setData("text",this.screen.target);for(let n of this.screen.target){const s=this.objectList[n];s&&s.parent&&(await R(),await(await w.get(s.parent))[s.parent.key].remove(n))}e.preventDefault()}t&&(this.screen.refs=[])},async paste(e){if(this.screen.targetPlace){e.preventDefault();const t=new P(this.screen.targetPlace),n=await w.get(t),s=n._schemaMix[t.key],u=e.clipboardData.getData("text"),r=[];let a=u.split(","),l=this.screen.refs;s.type!=="Array"&&(a.length&&(a.length=1),l.length&&(l=[this.screen.refs[0]]));for(let c of a)try{const f=await w.get(c);r.push(f)}catch{}if(!r.length&&l)for(let c of l)try{const f=await w.get(c);r.push(f)}catch{}if(r.length)if(s.type==="Array")for(let c of r)await n[t.key].push(c);else n[t.key]=r[0],await n._save()}},panelCtrl(e){this.panel===e?this.panel="":this.panel=e}},mounted(){this.init(),this.listenEvents(),document.addEventListener("copy",this.copy),document.addEventListener("cut",this.cut),document.addEventListener("paste",this.paste)},watch:{objectList:{handler:"makeNode",deep:!0},keyList:{handler:"makeNode",deep:!0},"screen.target":"makeTarget","screen.menu":"menuChange","screen.refs":"refChange"},beforeUnmount(){clearInterval(this.nodeTimer),this.removeEvents(),document.removeEventListener("copy",this.copy),document.removeEventListener("cut",this.cut),document.removeEventListener("paste",this.paste),w.removeEvent("ObjectEvents")}});const Ln={class:"nodeFns"},Bn={class:"nodeInfo"},Mn=["x","y","width","height"],An=["onMouseover","onMouseout","onMousedown"],Dn=["id","d"],Pn=["id","stroke","stroke-width","d"];function Sn(e,t,n,s,u,r){var I,U,Y;const a=v("YinObject"),l=v("fullscreen-exit-filled"),c=v("fullscreen-filled"),f=v("n-icon"),y=v("n-button"),L=v("save-all"),_=v("n-button-group"),k=v("yin-cloud-login"),F=v("yin-big-model"),B=v("yin-menu-structure"),$=v("yin-menu-object");return o(),h("div",{class:"nodeTree",ref:"table",onScroll:t[5]||(t[5]=(...E)=>e.screenCtrl&&e.screenCtrl(...E)),onResize:t[6]||(t[6]=(...E)=>e.screenCtrl&&e.screenCtrl(...E)),onClick:t[7]||(t[7]=(...E)=>e.refresh&&e.refresh(...E))},[m("div",{class:"nodes",ref:"nodes",onMousedown:t[0]||(t[0]=M((...E)=>e.lineStart&&e.lineStart(...E),["left"]))},[e.root._id?(o(),b(a,{key:0,object:e.root,style:N({paddingRight:e.panel?"350px":""})},null,8,["object","style"])):C("",!0)],544),m("header",Ln,[p(_,{class:"fns"},{default:i(()=>[p(y,{onClick:e.fullscreen},{default:i(()=>[p(f,{size:"21"},{default:i(()=>[e.isFullscreen?(o(),b(l,{key:0})):(o(),b(c,{key:1}))]),_:1})]),_:1},8,["onClick"]),e.$yin.me._isRoot?(o(),h(A,{key:0},[e.yinCabMe._token?(o(),b(y,{key:0,ghost:"",type:e.panel==="ai"?"primary":"default",onClick:t[1]||(t[1]=E=>e.panelCtrl("ai"))},{default:i(()=>[d("AI")]),_:1},8,["type"])):C("",!0)],64)):C("",!0),p(L),e.object?C("",!0):(o(),b(y,{key:1},{default:i(()=>[d(g(e.$yin.me._title||"我"),1)]),_:1}))]),_:1})]),m("div",Bn,[d(" screen "),m("pre",null,g(e.screen),1),m("pre",null,g(e.keyList.dotLining),1),d(" objectList "),m("pre",null,g(e.objectList),1),d(" keyList "),m("pre",null,g(e.keyList),1),d(" select "),m("pre",null,g(e.selectStartPlace),1),m("pre",null,g(e.selectNowPlace),1)]),e.panel==="yinCloud"?(o(),b(k,{key:0,class:"panel"})):C("",!0),e.panel==="ai"?(o(),b(F,{key:1,class:"panel"})):C("",!0),(I=e.screen.menu)!=null&&I.type?(o(),b(B,{key:2,ref:"menu",style:N({left:e.screen.menu.x+"px",top:e.screen.menu.y+"px"}),screen:e.screen,objectList:e.objectList},null,8,["style","screen","objectList"])):e.screen.menu?(o(),b($,{key:3,ref:"menu",style:N({left:e.screen.menu.x+"px",top:e.screen.menu.y+"px"}),screen:e.screen,objectList:e.objectList},null,8,["style","screen","objectList"])):C("",!0),(o(),h("svg",{class:"nodeLines",style:N({minWidth:(U=this.$refs.nodes)==null?void 0:U.scrollWidth,minHeight:(Y=this.$refs.nodes)==null?void 0:Y.scrollHeight}),onMousedown:t[2]||(t[2]=M((...E)=>e.selectStart&&e.selectStart(...E),["left"])),onMousemove:t[3]||(t[3]=E=>e.screen.menu?e.lining(E):""),onContextmenu:t[4]||(t[4]=M((...E)=>e.clearDotLining&&e.clearDotLining(...E),["right"]))},[e.selectNowPlace&&e.selectStartPlace?(o(),h("rect",{key:0,x:Math.min(e.selectStartPlace.x,e.selectNowPlace.x)-1,y:Math.min(e.selectStartPlace.y,e.selectNowPlace.y)-1,width:Math.abs(e.selectStartPlace.x-e.selectNowPlace.x),height:Math.abs(e.selectStartPlace.y-e.selectNowPlace.y),ry:"2",stroke:"#333",fill:"#fafafa","stroke-width":"1"},null,8,Mn)):C("",!0),(o(!0),h(A,null,z(e.lines,(E,V)=>(o(),h("g",{ref_for:!0,ref:V,onMouseover:O=>e.hoverLine(E,O),onMouseout:O=>e.outLine(E,O),onMousedown:M(O=>e.lineToDrag(E),["left","stop"])},[m("path",{class:"line",id:V+"-shadow",stroke:"rgba(0,0,0,0)","stroke-width":8,fill:"none",d:E.path},null,8,Dn),m("path",{class:"line",id:V,stroke:E.hover?"#333":"#666","stroke-width":E.hover?2:1,fill:"none",d:E.path},null,8,Pn)],40,An))),256))],36))],544)}const Vn=D(jn,[["render",Sn],["__scopeId","data-v-f5be5b43"]]);export{Vn as N};
//# sourceMappingURL=nodeTree-8e6f9f4b.js.map
